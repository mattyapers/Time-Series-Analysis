obama_mstl_fitted <- forecast_weekly + forecast_monthly + forecast_yearly + forecast_s_adj
autoplot(obama_mstl_fitted) +
autolayer(obama_test_daily)
williamson_mstl_fitted <- forecast_weekly_w + forecast_monthly_w + forecast_yearly_w + forecast_s_adj_w
forecast_s_adj_w <- (forecast(williamson_arima, h = 730.5))$mean
williamson_mstl_fitted <- forecast_weekly_w + forecast_monthly_w + forecast_yearly_w + forecast_s_adj_w
autoplot(williamson_mstl_fitted) +
autolayer(williamson_test_daily)
williamson_msts <- msts(williamson_train_daily, seasonal.periods = c(7,12,365.25))
williamson_mstl <- (mstl(msts(williamson_train_daily, seasonal.periods = c(7,12,365.25))))
#splitting into seasonal and seasonally adjusted
williamson_s_adj <- williamson_mstl[,2] + williamson_mstl[,6]
williamson_seasonal_weekly <- williamson_mstl[,3]
williamson_seasonal_monthly <- williamson_mstl[,4]
williamson_seasonal_yearly <- williamson_mstl[,5]
forecast_weekly_w <- snaive(williamson_seasonal_weekly , h = 730.5)$mean
forecast_monthly_w <- snaive(williamson_seasonal_monthly, h = 730.5)$mean
forecast_yearly_w <- snaive(williamson_seasonal_yearly, h = 730.5)$mean
williamson_arima <- auto.arima(williamson_s_adj)
forecast_s_adj_w <- (forecast(williamson_arima, h = 730.5))$mean
autoplot(williamson_train_daily) +
autolayer(forecast_weekly_w, series = "weekly") +
autolayer(forecast_monthly_w, series = "monthly") +
autolayer(forecast_yearly_w, series = "yearly") +
autolayer(forecast(williamson_arima, h = 730.5), series = "Seasonal adj")
williamson_mstl_fitted <- forecast_weekly_w + forecast_monthly_w + forecast_yearly_w + forecast_s_adj_w
autoplot(williamson_mstl_fitted) +
autolayer(williamson_test_daily)
accuracy(obama_mstl_fitted,obama_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
williamson_msts <- msts(williamson_train_daily, seasonal.periods = c(7,12,365.25), , start = c(2016,01))
williamson_msts <- msts(williamson_train_daily, seasonal.periods = c(7,12,365.25), start = c(2016,01))
williamson_msts <- msts(williamson_train_daily, seasonal.periods = c(7,12,365.25), start = c(2016,01))
williamson_mstl <- (mstl(msts(williamson_train_daily, seasonal.periods = c(7,12,365.25))))
#splitting into seasonal and seasonally adjusted
williamson_s_adj <- williamson_mstl[,2] + williamson_mstl[,6]
williamson_seasonal_weekly <- williamson_mstl[,3]
williamson_seasonal_monthly <- williamson_mstl[,4]
williamson_seasonal_yearly <- williamson_mstl[,5]
forecast_weekly_w <- snaive(williamson_seasonal_weekly , h = 730.5)$mean
forecast_monthly_w <- snaive(williamson_seasonal_monthly, h = 730.5)$mean
forecast_yearly_w <- snaive(williamson_seasonal_yearly, h = 730.5)$mean
williamson_arima <- auto.arima(williamson_s_adj)
forecast_s_adj_w <- (forecast(williamson_arima, h = 730.5))$mean
autoplot(williamson_train_daily) +
autolayer(forecast_weekly_w, series = "weekly") +
autolayer(forecast_monthly_w, series = "monthly") +
autolayer(forecast_yearly_w, series = "yearly") +
autolayer(forecast(williamson_arima, h = 730.5), series = "Seasonal adj")
williamson_mstl_fitted <- forecast_weekly_w + forecast_monthly_w + forecast_yearly_w + forecast_s_adj_w
autoplot(williamson_mstl_fitted) +
autolayer(williamson_test_daily)
accuracy(obama_mstl_fitted,obama_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
autoplot(williamson_mstl_fitted) +
autolayer(williamson_test_daily)
autoplot(williamson_mstl)
williamson_mstl <- mstl(williamson_msts)
williamson_msts <- msts(williamson_train_daily, seasonal.periods = c(7,12,365.25), start = c(2016,01))
williamson_mstl <- mstl(williamson_msts)
autoplot(williamson_mstl)
#splitting into seasonal and seasonally adjusted
williamson_s_adj <- williamson_mstl[,2] + williamson_mstl[,6]
williamson_seasonal_weekly <- williamson_mstl[,3]
williamson_seasonal_monthly <- williamson_mstl[,4]
williamson_seasonal_yearly <- williamson_mstl[,5]
forecast_weekly_w <- snaive(williamson_seasonal_weekly , h = 730.5)$mean
forecast_monthly_w <- snaive(williamson_seasonal_monthly, h = 730.5)$mean
forecast_yearly_w <- snaive(williamson_seasonal_yearly, h = 730.5)$mean
williamson_arima <- auto.arima(williamson_s_adj)
forecast_s_adj_w <- (forecast(williamson_arima, h = 730.5))$mean
autoplot(williamson_train_daily) +
autolayer(forecast_weekly_w, series = "weekly") +
autolayer(forecast_monthly_w, series = "monthly") +
autolayer(forecast_yearly_w, series = "yearly") +
autolayer(forecast(williamson_arima, h = 730.5), series = "Seasonal adj")
williamson_mstl_fitted <- forecast_weekly_w + forecast_monthly_w + forecast_yearly_w + forecast_s_adj_w
autoplot(williamson_mstl_fitted) +
autolayer(williamson_test_daily)
accuracy(obama_mstl_fitted,obama_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(williamson_mstl_fitted,williamson_test_daily))[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(williamson_mstl_fitted,williamson_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
biden_month_fitted_n <- forecast(stlf(biden_train_month, method = "naive",lambda = "auto"), h =24)$mean
# Monthly data
biden_pageviews_monthly <- article_pageviews(
article = "Joe_Biden",
granularity = "monthly",
start = "2016010100",
end = "2023123100"
)
## Average daily views per month
biden_ts <-ts(data = biden_pageviews_monthly$views, start = c(2016,1), frequency = 12)
biden_ts_DA <- biden_ts/monthdays(biden_ts)
biden_ts_DA
autoplot(biden_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average views per day in a month")
biden_month_fitted_n <- forecast(stlf(biden_train_month, method = "naive",lambda = "auto"), h =24)$mean
## Average daily views per month
biden_ts <-ts(data = biden_pageviews_monthly$views, start = c(2016,1), frequency = 12)
biden_ts_DA <- biden_ts/monthdays(biden_ts)
biden_ts_DA
autoplot(biden_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average views per day in a month")
# Monthly
biden_train_month <- window(biden_ts_DA, start = c(2016, 1), end = c(2021, 12))
biden_test_month <- window(biden_ts_DA, start = c(2022, 1))
biden_ts_daily <- ts(data = biden_pageviews_daily$views, start = c(2016,1), frequency = 365.25)
biden_month_fitted_n <- forecast(stlf(biden_train_month, method = "naive",lambda = "auto"), h =24)$mean
biden_month_fitted_d <- forecast(stlf(biden_train_month, method = "rwdrift",lambda = "auto"), h =24)$mean
biden_month_fitted_a <-forecast(stlf(biden_train_month, method = "arima",lambda = "auto"), h =24)$mean
# Accuracy computation
accuracy(biden_month_fitted_n, biden_test_month)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(biden_month_fitted_d, biden_test_month)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(biden_month_fitted_a, biden_test_month)[1,c("ME", "RMSE","MAE","MAPE")]
# Drift has the smallest RMSE of 3592.49487
williamson_daily_fitted_n <- forecast(stlf(williamson_train_daily, method = "naive",lambda = "auto"), h =730)$mean
williamson_daily_fitted_d <- forecast(stlf(williamson_train_daily, method = "rwdrift",lambda = "auto"), h =730)$mean
williamson_daily_fitted_a <-forecast(stlf(williamson_train_daily, method = "arima",lambda = "auto"), h =730)$mean
# Accuracy computation
accuracy(williamson_daily_fitted_n, williamson_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(williamson_daily_fitted_d, williamson_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(williamson_daily_fitted_a, williamson_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
# ARIMA has the smallest RMSE of 1373.57909.
biden_daily_fitted_n <- forecast(stlf(biden_train_daily, method = "naive",lambda = "auto"), h =730)$mean
biden_daily_fitted_d <- forecast(stlf(biden_train_daily, method = "rwdrift",lambda = "auto"), h =730)$mean
biden_daily_fitted_a <-forecast(stlf(biden_train_daily, method = "arima",lambda = "auto"), h =730)$mean
# Accuracy computation
accuracy(biden_daily_fitted_n, biden_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(biden_daily_fitted_d, biden_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(biden_daily_fitted_a, biden_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
# ARIMA has the smallest RMSE of 1373.57909.
biden_msts <- msts(biden_train_daily, seasonal.periods = c(7,12,365.25), start = c(2016,01))
biden_mstl <- mstl(biden_msts)
autoplot(biden_mstl)
#splitting into seasonal and seasonally adjusted
biden_s_adj <- biden_mstl[,2] + biden_mstl[,6]
biden_seasonal_weekly <- biden_mstl[,3]
biden_seasonal_monthly <- biden_mstl[,4]
biden_seasonal_yearly <- biden_mstl[,5]
forecast_weekly_b <- snaive(biden_seasonal_weekly , h = 730.5)$mean
forecast_monthly_b <- snaive(biden_seasonal_monthly, h = 730.5)$mean
forecast_yearly_b <- snaive(biden_seasonal_yearly, h = 730.5)$mean
biden_arima <- auto.arima(biden_s_adj)
forecast_s_adj_b <- (forecast(biden_arima, h = 730.5))$mean
autoplot(biden_train_daily) +
autolayer(forecast_weekly_b, series = "weekly") +
autolayer(forecast_monthly_b, series = "monthly") +
autolayer(forecast_yearly_b, series = "yearly") +
autolayer(forecast(biden_arima, h = 730.5), series = "Seasonal adj")
biden_mstl_fitted <- forecast_weekly_b + forecast_monthly_b + forecast_yearly_b + forecast_s_adj_b
autoplot(biden_mstl_fitted) +
autolayer(biden_test_daily)
accuracy(biden_mstl_fitted,biden_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
# RMSE of 7169.7752 and MAE of 2508.3038.
# ARIMA still has the smaller RMSE.
# Daily data for Republican Party
rep_pageviews_daily <- article_pageviews(
article = "Republican_Party_(United_States)",
granularity = "daily",
start = "2016010100",
end = "2023123100"
)
rep_ts_daily <- ts(data = rep_pageviews_daily$views, start = c(2016,1), frequency = 365.25)
# Daily data for Donald Trump
trump_pageviews_daily <- article_pageviews(
article = "Donald_Trump",
granularity = "daily",
start = "2016010100",
end = "2023123100"
)
trump_ts_daily <- ts(data = trump_pageviews_daily$views, start = c(2016,1), frequency = 365.25)
trump_train_daily <- window(trump_ts_daily, start = c(2016, 1), end = c(2021, 12))
trump_test_daily <- window(trump_ts_daily, start = c(2022, 1))
# Monthly data
trump_pageview_monthly <- article_pageviews(
article = "Donald_Trump",
granularity = "monthly",
start = "2016010100",
end = "2023123100"
)
## Average daily views per month
trump_ts <-ts(data = trump_pageview_monthly$views, start = c(2016,1), frequency = 12)
trump_ts_DA <- trump_ts/monthdays(trump_ts)
trump_ts_DA
autoplot(trump_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average views per day in a month")
# Monthly
trump_train_month <- window(trump_ts_DA, start = c(2016, 1), end = c(2021, 12))
trump_test_month <- window(trump_ts_DA, start = c(2022, 1))
trump_arimax <- auto.arima(trump_s_adj, xreg = window(rep_ts_daily,start = c(2016, 1), end = c(2021, 12)))
forecast_trump_s_adj <- forecast(trump_arimax, xreg = rep_ts_daily, h = 730.5)
forecast_trump <- forecast_trump_s_adj$mean + snaive(trump_seasonal_yearly, h = 730.5)$mean
forecast_trump <- pmax(ts(forecast_trump, start = c(2022, 1), frequency = 365.25), 0)
forecast_trump
MAE(forecast_trump, trump_test_daily)
trump_full <- (mstl(msts(trump_ts_daily, seasonal.periods = c(7,12,365.25))))
trump_full_s_adj <- trump_full[,2] + trump_full[,6]
trump_seasonal_yearly_full <- trump_full[,5]
trump_arimax_full <- auto.arima(trump_full_s_adj, xreg = rep_ts_daily)
forecast_trump_s_adj_full <- forecast(trump_arimax_full, xreg = rep_ts_daily, h = 365.25)
forecast_trump_full <- forecast_trump_s_adj_full$mean + snaive(trump_seasonal_yearly_full, h = 365.25)$mean
forecast_trump_full <- pmax(ts(forecast_trump_full, start = c(2024, 1), frequency = 365.25), 0)
autoplot(forecast_trump_full) + autolayer(trump_ts_daily)
trump_month_fitted_n <- forecast(stlf(trump_train_month, method = "naive",lambda = "auto"), h =24)$mean
trump_month_fitted_d <- forecast(stlf(trump_train_month, method = "rwdrift",lambda = "auto"), h =24)$mean
trump_month_fitted_a <-forecast(stlf(trump_train_month, method = "arima",lambda = "auto"), h =24)$mean
# Accuracy computation
accuracy(trump_month_fitted_n, trump_test_month)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(trump_month_fitted_d, trump_test_month)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(trump_month_fitted_a, trump_test_month)[1,c("ME", "RMSE","MAE","MAPE")]
# Drift has the smallest RMSE of 10662.25501.
trump_msts <- msts(trump_train_daily, seasonal.periods = c(7,12,365.25), start = c(2016,01))
trump_mstl <- mstl(trump_msts)
autoplot(trump_mstl)
#splitting into seasonal and seasonally adjusted
trump_s_adj <- trump_mstl[,2] + trump_mstl[,6]
trump_seasonal_weekly <- trump_mstl[,3]
trump_seasonal_monthly <- trump_mstl[,4]
trump_seasonal_yearly <- trump_mstl[,5]
forecast_weekly_t <- snaive(trump_seasonal_weekly , h = 730.5)$mean
forecast_monthly_t <- snaive(trump_seasonal_monthly, h = 730.5)$mean
forecast_yearly_t <- snaive(trump_seasonal_yearly, h = 730.5)$mean
biden_arima <- auto.arima(trump_s_adj)
forecast_s_adj_t <- (forecast(trump_arima, h = 730.5))$mean
trump_msts <- msts(trump_train_daily, seasonal.periods = c(7,12,365.25), start = c(2016,01))
trump_mstl <- mstl(trump_msts)
autoplot(trump_mstl)
#splitting into seasonal and seasonally adjusted
trump_s_adj <- trump_mstl[,2] + trump_mstl[,6]
trump_seasonal_weekly <- trump_mstl[,3]
trump_seasonal_monthly <- trump_mstl[,4]
trump_seasonal_yearly <- trump_mstl[,5]
forecast_weekly_t <- snaive(trump_seasonal_weekly , h = 730.5)$mean
forecast_monthly_t <- snaive(trump_seasonal_monthly, h = 730.5)$mean
forecast_yearly_t <- snaive(trump_seasonal_yearly, h = 730.5)$mean
trump_arima <- auto.arima(trump_s_adj)
forecast_s_adj_t <- (forecast(trump_arima, h = 730.5))$mean
autoplot(trump_train_daily) +
autolayer(forecast_weekly_t, series = "weekly") +
autolayer(forecast_monthly_t, series = "monthly") +
autolayer(forecast_yearly_t, series = "yearly") +
autolayer(forecast(trump_arima, h = 730.5), series = "Seasonal adj")
trump_mstl_fitted <- forecast_weekly_t + forecast_monthly_t + forecast_yearly_t + forecast_s_adj_t
autoplot(trump_mstl_fitted) +
autolayer(trump_test_daily)
accuracy(trump_mstl_fitted,trump_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
# RMSE of 166445.0480  and MAE of 130821.5293 .
# ARIMA still has the smaller RMSE.
library(pageviews)
library(fpp2)
library(dplyr)
library(lubridate)
library(ggplot2)
library(forecast)
library(feasts)
library(tsibble)
# Daily data for Williamson
williamson_pageviews_daily <- article_pageviews(
article = "Marianne_Williamson",
granularity = "daily",
start = "2016010100",
end = "2023123100"
)
williamson_train_daily <- window(williamson_ts_daily, start = c(2016, 1), end = c(2021, 12))
williamson_test_daily <- window(williamson_ts_daily, start = c(2022, 1))
# Monthly data
williamson_pageviews_monthly <- article_pageviews(
article = "Marianne_Williamson",
granularity = "monthly",
start = "2016010100",
end = "2023123100"
)
## Average daily views per month
williamson_ts <-ts(data = williamson_pageviews_monthly$views, start = c(2016,1), frequency = 12)
williamson_ts_DA <- williamson_ts/monthdays(williamson_ts)
williamson_ts_DA
autoplot(williamson_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average views per day in a month")
# Monthly
williamson_train_month <- window(williamson_ts_DA, start = c(2016, 1), end = c(2021, 12))
williamson_test_month <- window(williamson_ts_DA, start = c(2022, 1))
williamson_ts_daily <- ts(data = williamson_pageviews_daily$views, start = c(2016,1), frequency = 365.25)
williamson_month_fitted_n <- forecast(stlf(williamson_train_month, method = "naive",lambda = "auto"), h =24)$mean
williamson_month_fitted_d <- forecast(stlf(williamson_train_month, method = "rwdrift",lambda = "auto"), h =24)$mean
williamson_month_fitted_a <-forecast(stlf(williamson_train_month, method = "arima",lambda = "auto"), h =24)$mean
# Accuracy computation
accuracy(williamson_month_fitted_n, williamson_test_month)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(williamson_month_fitted_d, williamson_test_month)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(williamson_month_fitted_a, williamson_test_month)[1,c("ME", "RMSE","MAE","MAPE")]
# Drift has the smallest RMSE of 3592.49487
williamson_daily_fitted_n <- forecast(stlf(williamson_train_daily, method = "naive",lambda = "auto"), h =730)$mean
williamson_daily_fitted_d <- forecast(stlf(williamson_train_daily, method = "rwdrift",lambda = "auto"), h =730)$mean
williamson_daily_fitted_a <-forecast(stlf(williamson_train_daily, method = "arima",lambda = "auto"), h =730)$mean
# Accuracy computation
accuracy(williamson_daily_fitted_n, williamson_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(williamson_daily_fitted_d, williamson_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(williamson_daily_fitted_a, williamson_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
# ARIMA has the smallest RMSE of 1373.57909.
williamson_msts <- msts(williamson_train_daily, seasonal.periods = c(7,12,365.25), start = c(2016,01))
williamson_mstl <- mstl(williamson_msts)
autoplot(williamson_mstl)
#splitting into seasonal and seasonally adjusted
williamson_s_adj <- williamson_mstl[,2] + williamson_mstl[,6]
williamson_seasonal_weekly <- williamson_mstl[,3]
williamson_seasonal_monthly <- williamson_mstl[,4]
williamson_seasonal_yearly <- williamson_mstl[,5]
forecast_weekly_w <- snaive(williamson_seasonal_weekly , h = 730.5)$mean
forecast_monthly_w <- snaive(williamson_seasonal_monthly, h = 730.5)$mean
forecast_yearly_w <- snaive(williamson_seasonal_yearly, h = 730.5)$mean
williamson_arima <- auto.arima(williamson_s_adj)
forecast_s_adj_w <- (forecast(williamson_arima, h = 730.5))$mean
autoplot(williamson_train_daily) +
autolayer(forecast_weekly_w, series = "weekly") +
autolayer(forecast_monthly_w, series = "monthly") +
autolayer(forecast_yearly_w, series = "yearly") +
autolayer(forecast(williamson_arima, h = 730.5), series = "Seasonal adj")
williamson_mstl_fitted <- forecast_weekly_w + forecast_monthly_w + forecast_yearly_w + forecast_s_adj_w
autoplot(williamson_mstl_fitted) +
autolayer(williamson_test_daily)
accuracy(williamson_mstl_fitted,williamson_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
# RMSE of 7169.7752 and MAE of 2508.3038.
# ARIMA still has the smaller RMSE.
library(pageviews)
library(fpp2)
library(dplyr)
library(lubridate)
library(ggplot2)
library(forecast)
library(feasts)
library(tsibble)
# Daily data for Williamson
williamson_pageviews_daily <- article_pageviews(
article = "Marianne_Williamson",
granularity = "daily",
start = "2016010100",
end = "2023123100"
)
williamson_train_daily <- window(williamson_ts_daily, start = c(2016, 1), end = c(2021, 12))
library(pageviews)
library(fpp2)
library(dplyr)
library(lubridate)
library(ggplot2)
library(forecast)
library(feasts)
library(tsibble)
# Daily data for Williamson
williamson_pageviews_daily <- article_pageviews(
article = "Marianne_Williamson",
granularity = "daily",
start = "2016010100",
end = "2023123100"
)
williamson_ts_daily <-ts(data = williamson_pageviews_daily$views, start = c(2016,1), frequency = 12)
williamson_train_daily <- window(williamson_ts_daily, start = c(2016, 1), end = c(2021, 12))
williamson_test_daily <- window(williamson_ts_daily, start = c(2022, 1))
# Monthly data
williamson_pageviews_monthly <- article_pageviews(
article = "Marianne_Williamson",
granularity = "monthly",
start = "2016010100",
end = "2023123100"
)
## Average daily views per month
williamson_ts <-ts(data = williamson_pageviews_monthly$views, start = c(2016,1), frequency = 12)
williamson_ts_DA <- williamson_ts/monthdays(williamson_ts)
williamson_ts_DA
autoplot(williamson_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average Daily Views per Month")
# Monthly
williamson_train_month <- window(williamson_ts_DA, start = c(2016, 1), end = c(2021, 12))
williamson_test_month <- window(williamson_ts_DA, start = c(2022, 1))
williamson_ts_daily <- ts(data = williamson_pageviews_daily$views, start = c(2016,1), frequency = 365.25)
williamson_month_fitted_n <- forecast(stlf(williamson_train_month, method = "naive",lambda = "auto"), h =24)$mean
williamson_month_fitted_d <- forecast(stlf(williamson_train_month, method = "rwdrift",lambda = "auto"), h =24)$mean
williamson_month_fitted_a <-forecast(stlf(williamson_train_month, method = "arima",lambda = "auto"), h =24)$mean
# Accuracy computation
accuracy(williamson_month_fitted_n, williamson_test_month)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(williamson_month_fitted_d, williamson_test_month)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(williamson_month_fitted_a, williamson_test_month)[1,c("ME", "RMSE","MAE","MAPE")]
# Drift has the smallest RMSE of 3592.49487
# Fitting models and computing accuracy
williamson_daily_fitted_n <- forecast(stlf(williamson_train_daily, method = "naive", lambda = "auto"), h = 730)$mean
# Monthly data
obama_pageviews_monthly <- article_pageviews(
article = "Barack_Obama",
granularity = "monthly",
start = "2016010100",
end = "2023123100"
)
## Average daily views per month
obama_ts <-ts(data = obama_pageviews_monthly$views, start = c(2016,1), frequency = 12)
obama_ts_DA <- obama_ts/monthdays(obama_ts)
obama_ts_DA
autoplot(obama_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average Daily Views per Month")
# Daily data
obama_pageviews_daily <- article_pageviews(
article = "Barack_Obama",
granularity = "daily",
start = "2016010100",
end = "2023123100"
)
## Daily timeseries
obama_ts_daily <-ts(data = obama_pageviews_daily$views, start = c(2016,01), frequency = 365.25)
autoplot(obama_ts_daily) +
xlab("Years") + ylab("Views") +
ggtitle("Average Daily Views")
obama_pageviews_daily$date[which.max(obama_pageviews_daily$views)]
#train-test split
obama_train_month <- window(obama_ts_DA, start=c(2016, 1), end = c(2021, 12))
obama_test_month <- window(obama_ts_DA, start = c(2022, 1))
#train-test split daily
obama_train_daily <- window(obama_ts_daily, start = c(2016, 1), end = c(2021, 12))
obama_test_daily <- window(obama_ts_daily, start = c(2022, 1))
# autoplot(decompose(obama_train_month)) + ggtitle("Decomposition of Average Daily Views by Month")
autoplot(obama_train_month) +
autolayer(forecast(stlf(obama_train_month, method = "naive",lambda = "auto"), h =24), series = "Naive", PI = FALSE) +
autolayer(forecast(stlf(obama_train_month, method = "rwdrift",lambda = "auto"), h =24), series = "Drift", PI = FALSE) +
autolayer(forecast(stlf(obama_train_month, method = "arima",lambda = "auto"), h =24), series = "ARIMA", PI = FALSE) +
ggtitle("STLF Decomposition of Average Daily Views per Month")
# autoplot(decompose(obama_train_daily)) + ggtitle("Decomposition of Average Daily Views")
autoplot(obama_train_daily) +
autolayer(forecast(stlf(obama_train_daily, method = "naive",lambda = "auto"), h = 730), series = "Naive", PI = FALSE) +
autolayer(forecast(stlf(obama_train_daily, method = "rwdrift",lambda = "auto"), h = 730), series = "Drift", PI = FALSE) +
autolayer(forecast(stlf(obama_train_daily, method = "arima",lambda = "auto"), h = 730), series = "ARIMA", PI = FALSE) +
ggtitle("STLF Decomposition of Average Daily Views")
obama_month_fitted_n <- forecast(stlf(obama_train_month, method = "naive",lambda = "auto"), h =24)$mean
obama_month_fitted_d <- forecast(stlf(obama_train_month, method = "rwdrift",lambda = "auto"), h =24)$mean
obama_month_fitted_a <-forecast(stlf(obama_train_month, method = "arima",lambda = "auto"), h =24)$mean
# Accuracy computation
accuracy(obama_month_fitted_n, obama_test_month)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(obama_month_fitted_d, obama_test_month)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(obama_month_fitted_a, obama_test_month)[1,c("ME", "RMSE","MAE","MAPE")]
# Negative ME from ARIMA model suggests that it tends to underestimate the quantity being predicted but has the smallest RMSE of 10112.8453.
obama_daily_fitted_n <- forecast(stlf(obama_train_daily, method = "naive",lambda = "auto"), h = 730)$mean
obama_daily_fitted_d <- forecast(stlf(obama_train_daily, method = "rwdrift",lambda = "auto"), h = 730)$mean
obama_daily_fitted_a <-forecast(stlf(obama_train_daily, method = "arima",lambda = "auto"), h = 730)$mean
# Accuracy computation
accuracy(obama_daily_fitted_n, obama_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(obama_daily_fitted_d, obama_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(obama_daily_fitted_a, obama_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
# Negative ME from ARIMA model suggests that it tends to underestimate the quantity being predicted, naive has the smallest RMSE of 17185.95260.
williamson_train_daily
williamson_ts_daily <-ts(data = williamson_pageviews_daily$views, start = c(2016,1), frequency = 365.25)
williamson_train_daily <- window(williamson_ts_daily, start = c(2016, 1), end = c(2021, 12))
williamson_test_daily <- window(williamson_ts_daily, start = c(2022, 1))
williamson_test_daily <- window(williamson_ts_daily, start = c(2022, 1))
# Daily data for Williamson
williamson_pageviews_daily <- article_pageviews(
article = "Marianne_Williamson",
granularity = "daily",
start = "2016010100",
end = "2023123100"
)
williamson_ts_daily <- ts(data = williamson_pageviews_daily$views, start = c(2016,1), frequency = 365.25)
williamson_train_daily <- window(williamson_ts_daily, start = c(2016, 1), end = c(2021, 12))
williamson_test_daily <- window(williamson_ts_daily, start = c(2022, 1))
# Monthly data
williamson_pageviews_monthly <- article_pageviews(
article = "Marianne_Williamson",
granularity = "monthly",
start = "2016010100",
end = "2023123100"
)
## Average daily views per month
williamson_ts <-ts(data = williamson_pageviews_monthly$views, start = c(2016,1), frequency = 12)
williamson_ts_DA <- williamson_ts/monthdays(williamson_ts)
williamson_ts_DA
autoplot(williamson_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average Daily Views per Month")
# Monthly
williamson_train_month <- window(williamson_ts_DA, start = c(2016, 1), end = c(2021, 12))
williamson_test_month <- window(williamson_ts_DA, start = c(2022, 1))
# Fitting models and computing accuracy
williamson_daily_fitted_n <- forecast(stlf(williamson_train_daily, method = "naive", lambda = "auto"), h = 730)$mean
williamson_daily_fitted_d <- forecast(stlf(williamson_train_daily, method = "rwdrift", lambda = "auto"), h = 730)$mean
williamson_daily_fitted_a <- forecast(stlf(williamson_train_daily, method = "arima", lambda = "auto"), h = 730)$mean
# Accuracy computation
accuracy(williamson_daily_fitted_n, williamson_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(williamson_daily_fitted_d, williamson_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
accuracy(williamson_daily_fitted_a, williamson_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
# ARIMA has the smallest RMSE of 1373.57909.
williamson_msts <- msts(williamson_train_daily, seasonal.periods = c(7,12,365.25), start = c(2016,01))
williamson_mstl <- mstl(williamson_msts)
autoplot(williamson_mstl)
#splitting into seasonal and seasonally adjusted
williamson_s_adj <- williamson_mstl[,2] + williamson_mstl[,6]
williamson_seasonal_weekly <- williamson_mstl[,3]
williamson_seasonal_monthly <- williamson_mstl[,4]
williamson_seasonal_yearly <- williamson_mstl[,5]
forecast_weekly_w <- snaive(williamson_seasonal_weekly , h = 730.5)$mean
forecast_monthly_w <- snaive(williamson_seasonal_monthly, h = 730.5)$mean
forecast_yearly_w <- snaive(williamson_seasonal_yearly, h = 730.5)$mean
williamson_arima <- auto.arima(williamson_s_adj)
forecast_s_adj_w <- (forecast(williamson_arima, h = 730.5))$mean
autoplot(williamson_train_daily) +
autolayer(forecast_weekly_w, series = "weekly") +
autolayer(forecast_monthly_w, series = "monthly") +
autolayer(forecast_yearly_w, series = "yearly") +
autolayer(forecast(williamson_arima, h = 730.5), series = "Seasonal adj")
williamson_mstl_fitted <- forecast_weekly_w + forecast_monthly_w + forecast_yearly_w + forecast_s_adj_w
autoplot(williamson_mstl_fitted) +
autolayer(williamson_test_daily)
accuracy(williamson_mstl_fitted,williamson_test_daily)[1,c("ME", "RMSE","MAE","MAPE")]
# RMSE of 7169.7752 and MAE of 2508.3038.
# ARIMA still has the smaller RMSE.
