autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") +
#guides(colour = guide_legend(title = "Forecast"))
## Mean
checkresiduals(meanf(obama_train, h = 24), series = "Mean", PI = FALSE) # There is significant autocorrelation, residuals are normally distributed, mean of the residuals is close to 0
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") #+
obama_train_mean <- meanf(obama_train, h = 24)
obama_train_naive <- naive(obama_train, h = 24)
obama_train_snaive <- snaive(obama_train, h = 24)
obama_train_drift <- rwf(obama_train, drift = TRUE, h = 24)
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") #+
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") #+
autoplot(obama_train)
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE)
autoplot(obama_train) +
plot(obama_train_mean, series = "Mean", PI = FALSE)
autoplot(obama_train) +
plot(obama_train_mean, PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") #+
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE)
autoplot(obama_train) +
plot(obama_train_mean, series = "Mean", PI = FALSE)
# Build complex model
## ARIMA
nsdiffs(obama_train) #returns 0
ndiffs(obama_train) #returns 0
acf(obama_ts_DA, lag.max = 96) #slow decaying, indicating presence of AR.
pacf(obama_train, lag.max = 96) #random spikes, indicating seasonal MA component
Arima(obama_train, order = c(1,0,0), seasonal = c(0,0,1))
Arima(obama_train, order = c(1,0,1), seasonal = c(0,0,1))
Arima(obama_train, order = c(1,0,1), seasonal = c(1,0,1))
#ARIMA(1,0,1)(1,0,1) returned the lowest AICc of -1125.53
#auto arima
obama_auto_arima <- auto.arima(obama_train)
obama_auto_arima #auto arima returned ARIMA(1,0,0)(0,0,1) with AICc of -1127.92
#ARIMA forecasting
obama_arima <- Arima(obama_train, order = c(1,0,1), seasonal = c(1,0,1))
obama_auto_arima_fc <- forecast(obama_auto_arima, h = 24)
obama_arima_fc <- forecast(obama_arima, h = 24)
obama_arima_fc
checkresiduals(obama_arima_fc)
checkresiduals(obama_auto_arima_fc)
obama_auto_arima_error <-  (InvBoxCox(unlist(obama_auto_arima_fc$mean) , lambda = obama_lambda) - obama_test)
mean(obama_auto_arima_error)
obama_arima_error <-  (InvBoxCox(unlist(obama_arima_fc$mean) , lambda = obama_lambda) - obama_test)
mean(obama_arima_error)
#Auto ARIMA gave a lower absolute error
autoplot(InvBoxCox(unlist(obama_arima_fc$mean) , lambda = obama_lambda), series = "ARIMA(1,0,1)(1,0,1)") + autolayer(obama_test) + autolayer(InvBoxCox(unlist(obama_auto_arima_fc$mean) , lambda = obama_lambda), series = "ARIMA(1,0,0)(0,0,1)")
# Build complex model
## ARIMA
nsdiffs(obama_train) #returns 0
ndiffs(obama_train) #returns 0
acf(obama_ts_DA, lag.max = 96) #slow decaying, indicating presence of AR.
pacf(obama_train, lag.max = 96) #random spikes, indicating seasonal MA component
Arima(obama_train, order = c(1,0,0), seasonal = c(0,0,1))
Arima(obama_train, order = c(1,0,1), seasonal = c(0,0,1))
Arima(obama_train, order = c(1,0,1), seasonal = c(1,0,1))
#ARIMA(1,0,1)(1,0,1) returned the lowest AICc of -1125.53
#auto arima
obama_auto_arima <- auto.arima(obama_train)
obama_auto_arima #auto arima returned ARIMA(1,0,0)(0,0,1) with AICc of -1127.92
#ARIMA forecasting
obama_arima <- Arima(obama_train, order = c(1,0,1), seasonal = c(1,0,1))
obama_auto_arima_fc <- forecast(obama_auto_arima, h = 24)
obama_arima_fc <- forecast(obama_arima, h = 24)
obama_arima_fc
checkresiduals(obama_arima_fc)
checkresiduals(obama_auto_arima_fc)
obama_auto_arima_error <-  (InvBoxCox(unlist(obama_auto_arima_fc$mean) , lambda = obama_lambda) - obama_test)
mean(obama_auto_arima_error)
obama_arima_error <-  (InvBoxCox(unlist(obama_arima_fc$mean) , lambda = obama_lambda) - obama_test)
mean(obama_arima_error)
#Auto ARIMA gave a lower absolute error
autoplot(InvBoxCox(unlist(obama_arima_fc$mean) , lambda = obama_lambda), series = "ARIMA(1,0,1)(1,0,1)") + autolayer(obama_test) + autolayer(InvBoxCox(unlist(obama_auto_arima_fc$mean) , lambda = obama_lambda), series = "ARIMA(1,0,0)(0,0,1)")
obama_train_mean <- meanf(obama_train, h = 24)
obama_train_naive <- naive(obama_train, h = 24)
obama_train_snaive <- snaive(obama_train, h = 24)
obama_train_drift <- rwf(obama_train, drift = TRUE, h = 24)
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") #+
## Naive
checkresiduals(naive(obama_train, h = 24), series = "Naive", PI = FALSE) # There is no significant autocorrelation else for the first lag,residuals are relatively normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_naive$mean), lambda = obama_lambda), obama_test)
# library(httr)
# library(jsonlite)
library(pageviews)
library(fpp2)
library(dplyr)
library(lubridate)
library(ggplot2)
library(forecast)
# 2020
## Democrats
# Obama announced that he would run for president in Feb 2007
obama_pageviews <- article_pageviews(
article = "Barack_Obama",
granularity = "monthly",
start = "2016010100",
end = "2023123100"
)
tail(obama_pageviews)
obama_ts <-ts(data = obama_pageviews$views, start = c(2016,1), frequency = 12)
obama_ts_DA <- obama_ts/monthdays(obama_ts)
obama_ts_DA
autoplot(obama_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average views per day")
# There are significant lags in r1,2,3 and in r19 to 24
obama_lambda <- BoxCox.lambda(obama_ts_DA)
obama_bc <- BoxCox(obama_ts_DA, obama_lambda)
autoplot(obama_bc)
#train-test split
obama_train <- window(obama_bc, start=c(2016, 1), end = c(2021, 12))
obama_test <- window(obama_ts_DA, start = c(2022, 1), end = c(2023, 12))
obama_train_mean <- meanf(obama_train, h = 24)
obama_train_naive <- naive(obama_train, h = 24)
obama_train_snaive <- snaive(obama_train, h = 24)
obama_train_drift <- rwf(obama_train, drift = TRUE, h = 24)
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") #+
#guides(colour = guide_legend(title = "Forecast"))
## Mean
checkresiduals(meanf(obama_train, h = 24), series = "Mean", PI = FALSE) # There is significant autocorrelation, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_mean$mean), lambda = obama_lambda), obama_test)
## Naive
checkresiduals(naive(obama_train, h = 24), series = "Naive", PI = FALSE) # There is no significant autocorrelation else for the first lag,residuals are relatively normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_naive$mean), lambda = obama_lambda), obama_test)
## Snaive
checkresiduals(snaive(obama_train, h = 24), series = "Seasonal Naive", PI = FALSE) # There is significant autocorrelation in a decaying pattern, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_snaive$mean), lambda = obama_lambda), obama_test)
## Drift
checkresiduals(rwf(obama_train, drift = TRUE, h = 24), series = "Drift", PI = FALSE) # There is significant autocorrelation for the first lag, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_drift$mean), lambda = obama_lambda), obama_test)
# Naive has the lowest MAE compared to
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
autoplot(stl(obama_train, s.window="periodic"))
obama_seasonal_component <- seasonal(decompose(x = obama_train, type = "multiplicative"))
obama_seasonaladj_component <- seasadj(decompose(x = obama_train, type = "multiplicative"))
autoplot(decompose(x = obama_ts_DA, type = "additive"))
obama_seasonal_component_additive <- seasonal(decompose(x = obama_ts_DA, type = "additive"))
obama_seasonaladj_component_additive <- seasadj(decompose(x = obama_ts_DA, type = "additive"))
additivefitted <- (snaive(obama_seasonal_component_additive))$fitted + (naive(obama_seasonaladj_component_additive))$fitted
obama_residuals_additive <- obama_ts_DA - additivefitted
Box.test(obama_residuals_additive, type = c("Ljung-Box")) # p-value is 0.9752 > 0.05 do not reject the null hypothesis. Residuals do not contain autocorrelation.
autoplot(obama_ts_DA) + autolayer(obama_residuals) + autolayer(obama_residuals_additive) # Multiplicative decomposition is indeed better
accuracy(additivefitted, x = obama_ts_DA)
accuracy(multiplicativefitted, x = obama_ts_DA) # Multiplicative has smaller MAE, RMSE, MAPE
autoplot(obama_residuals) + autolayer(obama_residuals_additive)
accuracy(additivefitted, x = obama_ts_DA)
accuracy(multiplicativefitted, x = obama_ts_DA) # Multiplicative has smaller MAE, RMSE, MAPE
Box.test(obama_residuals_additive, type = c("Ljung-Box")) # p-value is 0.9752 > 0.05 do not reject the null hypothesis. Residuals do not contain autocorrelation.
obama_seasonal_component
obama_seasonal_component <- seasonal(decompose(x = obama_train, type = "multiplicative",h = 24))
obama_seasonal_component <- seasonal(decompose(x = obama_train, type = "multiplicative"))
obama_seasonaladj_component <- seasadj(decompose(x = obama_train, type = "multiplicative"))
obama_seasonaladj_component_mean <- (naive(obama_seasonaladj_component))$fitted
obama_seasonaladj_component_mean
obama_seasonaladj_component_mean <- (naive(obama_seasonaladj_component, h = 24))$fitted
obama_seasonaladj_component_mean
obama_seasonaladj_component_drift <- (drift(obama_seasonaladj_component, h = 24, drift = TRUE))$fitted
obama_seasonaladj_component_mean <- (meanf(obama_seasonaladj_component, h = 24))$fitted
obama_seasonaladj_component_naive <- (naive(obama_seasonaladj_component, h = 24))$fitted
obama_seasonaladj_component_snaive <- (snaive(obama_seasonaladj_component, h = 24))$fitted
obama_seasonaladj_component_drift <- (rwf(obama_seasonaladj_component, h = 24, drift = TRUE))$fitted
multiplicativefitted_mean <- obama_seasonaladj_component_mean * obama_seasonal_component
multiplicativefitted_naive <- obama_seasonaladj_component_naive * obama_seasonal_component
multiplicativefitted_snaive <- obama_seasonaladj_component_snaive * obama_seasonal_component
multiplicativefitted_drift <- obama_seasonaladj_component_drift * obama_seasonal_component
obama_seasonaladj_component_mean <- (meanf(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_naive <- (naive(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_snaive <- (snaive(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_drift <- (rwf(obama_seasonaladj_component, h = 24, drift = TRUE))
obama_seasonaladj_component_mean
multiplicativefitted_mean <- obama_seasonaladj_component_mean$fitted * obama_seasonal_component$fitted
obama_seasonal_component_snaive <- snaive(obama_seasonal_component, h = 24)
obama_seasonal_component_snaive <- snaive(obama_seasonal_component, h = 24)
obama_seasonaladj_component_mean <- (meanf(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_naive <- (naive(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_snaive <- (snaive(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_drift <- (rwf(obama_seasonaladj_component, h = 24, drift = TRUE))
multiplicativefitted_mean <- obama_seasonaladj_component_mean$fitted * obama_seasonal_component_snaive$fitted
multiplicativefitted_naive <- obama_seasonaladj_component_naive$fitted * obama_seasonal_component_snaive$fitted
multiplicativefitted_snaive <- obama_seasonaladj_component_snaive$fitted * obama_seasonal_component_snaive$fitted
multiplicativefitted_drift <- obama_seasonaladj_component_drift$fitted * obama_seasonal_component_snaive$fitted
obama_multiplicativefitted_mean_resid <- obama_test - InvBoxCox(unlist(multiplicativefitted_mean))
obama_multiplicativefitted_mean_resid <- obama_test - InvBoxCox(unlist(multiplicativefitted_mean), lambda = obama_lambda)
autoplot(obama_multiplicativefitted_mean_resid)
InvBoxCox(unlist(multiplicativefitted_mean), lambda = obama_lambda)
autoplot(InvBoxCox(unlist(multiplicativefitted_mean), lambda = obama_lambda))
obama_test
obama_train
obama_seasonal_component
autoplot(stl(obama_train, s.window="periodic"))
obama_seasonal_component <- seasonal(decompose(x = obama_train, type = "multiplicative"))
obama_seasonaladj_component <- seasadj(decompose(x = obama_train, type = "multiplicative"))
obama_seasonal_component_snaive <- snaive(obama_seasonal_component, h = 24)
obama_seasonal_component_snaive
obama_seasonaladj_component_mean <- (meanf(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_naive <- (naive(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_snaive <- (snaive(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_drift <- (rwf(obama_seasonaladj_component, h = 24, drift = TRUE))
obama_seasonaladj_component_mean
multiplicativefitted_mean <- obama_seasonaladj_component_mean$fitted * obama_seasonal_component_snaive$fitted
multiplicativefitted_mean
obama_seasonaladj_component_mean$fitted
obama_seasonaladj_component_mean
names(obama_seasonaladj_component_mean)
start(multiplicativefitted_mean)
start(obama_seasonaladj_component_mean)
start(obama_seasonal_component_snaive)
obama_seasonal_component_snaive
obama_seasonal_component_snaive$fitted
obama_seasonal_component_snaive$mean
multiplicativefitted_mean <- obama_seasonaladj_component_mean$mean * obama_seasonal_component_snaive$mean
obama_multiplicativefitted_mean_resid <- obama_test - InvBoxCox(unlist(multiplicativefitted_mean), lambda = obama_lambda)
autoplot(obama_multiplicativefitted_mean_resid)
multiplicativefitted_mean <- obama_seasonaladj_component_mean$mean * obama_seasonal_component_snaive$mean
multiplicativefitted_naive <- obama_seasonaladj_component_naive$mean * obama_seasonal_component_snaive$mean
multiplicativefitted_snaive <- obama_seasonaladj_component_snaive$mean * obama_seasonal_component_snaive$mean
multiplicativefitted_drift <- obama_seasonaladj_component_drift$mean * obama_seasonal_component_snaive$mean
obama_multiplicativefitted_mean_resid <- obama_test - InvBoxCox(unlist(multiplicativefitted_mean), lambda = obama_lambda)
obama_multiplicativefitted_naive_resid <- obama_test - InvBoxCox(unlist(multiplicativefitted_naive), lambda = obama_lambda)
obama_multiplicativefitted_snaive_resid <- obama_test - InvBoxCox(unlist(multiplicativefitted_snaive), lambda = obama_lambda)
obama_multiplicativefitted_drift_resid <- obama_test - InvBoxCox(unlist(multiplicativefitted_drift), lambda = obama_lambda)
autoplot(obama_multiplicativefitted_mean_resid) + autolayer(obama_multiplicativefitted_naive_resid) + autolayer(obama_multiplicativefitted_snaive_resid) + autolayer(obama_multiplicativefitted_drift_resid)
mstl(obama_ts_DA)
autoplot(mstl(obama_ts_da))
autoplot(mstl(obama_ts_DA))
nsdiffs(obama_seasonaladj_component)
nsdiffs(obama_seasonaladj_component)
nsdiffs(obama_seasonal_component)
ndiffs(nsdiffs(obama_seasonal_component))
nsdiffs(obama_seasonal_component, 1)
nsdiffs(obama_seasonal_component)
# Check for stationary
nsdiffs(obama_seasonal_component)
ndiffs(diff(obama_seasonal_component, 1))
obama_seasonal_component <- diff(obama_seasonal_component)
obama_seasonaladj_component <- seasadj(decompose(x = obama_train, type = "multiplicative"))
obama_seasonal_component_snaive <- snaive(obama_seasonal_component, h = 24)
obama_seasonaladj_component_mean <- (meanf(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_naive <- (naive(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_snaive <- (snaive(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_drift <- (rwf(obama_seasonaladj_component, h = 24, drift = TRUE))
multiplicativefitted_mean <- obama_seasonaladj_component_mean$mean * obama_seasonal_component_snaive$mean
multiplicativefitted_naive <- obama_seasonaladj_component_naive$mean * obama_seasonal_component_snaive$mean
multiplicativefitted_snaive <- obama_seasonaladj_component_snaive$mean * obama_seasonal_component_snaive$mean
multiplicativefitted_drift <- obama_seasonaladj_component_drift$mean * obama_seasonal_component_snaive$mean
obama_multiplicativefitted_mean_resid <- obama_test - InvBoxCox(unlist(multiplicativefitted_mean), lambda = obama_lambda)
obama_multiplicativefitted_naive_resid <- obama_test - InvBoxCox(unlist(multiplicativefitted_naive), lambda = obama_lambda)
obama_multiplicativefitted_snaive_resid <- obama_test - InvBoxCox(unlist(multiplicativefitted_snaive), lambda = obama_lambda)
obama_multiplicativefitted_drift_resid <- obama_test - InvBoxCox(unlist(multiplicativefitted_drift), lambda = obama_lambda)
autoplot(obama_test) +
autolayer(InvBoxCox(unlist(multiplicativefitted_mean), lambda = obama_lambda))
autoplot(obama_test) +
autolayer(InvBoxCox(unlist(multiplicativefitted_mean), lambda = obama_lambda))+
autolayer(InvBoxCox(unlist(multiplicativefitted_naive), lambda = obama_lambda))
InvBoxCox(unlist(multiplicativefitted_naive), lambda = obama_lambda)
obama_multiplicativefitted_mean_resid <- obama_test - InvBoxCox(unlist(multiplicativefitted_mean$mean), lambda = obama_lambda)
obama_multiplicativefitted_mean_resid <- obama_test - InvBoxCox(unlist(multiplicativefitted_mean)$mean, lambda = obama_lambda)
obama_multiplicativefitted_mean_resid <- obama_test - InvBoxCox((multiplicativefitted_mean), lambda = obama_lambda))
obama_multiplicativefitted_mean_resid <- obama_test - InvBoxCox((multiplicativefitted_mean), lambda = obama_lambda)
obama_multiplicativefitted_mean_resid
autoplot(obama_test) +
autolayer(InvBoxCox((multiplicativefitted_mean), lambda = obama_lambda))+
autolayer(InvBoxCox((multiplicativefitted_naive), lambda = obama_lambda))
obama_multiplicativefitted_mean_resid
obama_multiplicativefitted_naive_resid <- obama_test - InvBoxCox((multiplicativefitted_naive), lambda = obama_lambda)
InvBoxCox((multiplicativefitted_naive), lambda = obama_lambda)
multiplicativefitted_drift
# 2020
## Democrats
# Obama announced that he would run for president in Feb 2007
obama_pageviews <- article_pageviews(
article = "Barack_Obama",
granularity = "monthly",
start = "2016010100",
end = "2023123100"
)
tail(obama_pageviews)
obama_ts <-ts(data = obama_pageviews$views, start = c(2016,1), frequency = 12)
obama_ts_DA <- obama_ts/monthdays(obama_ts)
obama_ts_DA
autoplot(obama_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average views per day")
# There are significant lags in r1,2,3 and in r19 to 24
obama_lambda <- BoxCox.lambda(obama_ts_DA)
obama_bc <- BoxCox(obama_ts_DA, obama_lambda)
autoplot(obama_bc)
obama_lambda
InvBoxCox(multiplicativefitted_drift, lambda = obama_lambda)
InvBoxCox(multiplicativefitted_mean, lambda = obama_lambda)
autoplot(stl(obama_train, s.window="periodic"))
obama_seasonal_component <- seasonal(decompose(x = obama_train, type = "multiplicative"))
# Check for stationary
nsdiffs(obama_seasonal_component)
ndiffs(diff(obama_seasonal_component, 1))
obama_seasonal_component <- diff(obama_seasonal_component)
obama_seasonaladj_component <- seasadj(decompose(x = obama_train, type = "multiplicative"))
obama_seasonal_component_snaive <- snaive(obama_seasonal_component, h = 24)
obama_seasonaladj_component_mean <- (meanf(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_naive <- (naive(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_snaive <- (snaive(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_drift <- (rwf(obama_seasonaladj_component, h = 24, drift = TRUE))
multiplicativefitted_mean <- obama_seasonaladj_component_mean$mean * obama_seasonal_component_snaive$mean
multiplicativefitted_naive <- obama_seasonaladj_component_naive$mean * obama_seasonal_component_snaive$mean
multiplicativefitted_snaive <- obama_seasonaladj_component_snaive$mean * obama_seasonal_component_snaive$mean
multiplicativefitted_drift <- obama_seasonaladj_component_drift$mean * obama_seasonal_component_snaive$mean
obama_multiplicativefitted_mean_resid <- obama_test - InvBoxCox((multiplicativefitted_mean), lambda = obama_lambda)
obama_multiplicativefitted_naive_resid <- obama_test - InvBoxCox((multiplicativefitted_naive), lambda = obama_lambda)
obama_multiplicativefitted_snaive_resid <- obama_test - InvBoxCox((multiplicativefitted_snaive), lambda = obama_lambda)
obama_multiplicativefitted_drift_resid <- obama_test - InvBoxCox((multiplicativefitted_drift), lambda = obama_lambda)
autoplot(obama_test) +
autolayer(InvBoxCox((multiplicativefitted_mean), lambda = obama_lambda)) +
autolayer(InvBoxCox((multiplicativefitted_naive), lambda = obama_lambda))
obama_seasonal_component <- seasonal(decompose(x = obama_train, type = "multiplicative"))
# Check for stationary
nsdiffs(obama_seasonal_component)
ndiffs(diff(obama_seasonal_component, 1))
obama_seasonal_component <- diff(obama_seasonal_component)
obama_seasonaladj_component <- seasadj(decompose(x = obama_train, type = "multiplicative"))
obama_seasonal_component_snaive <- snaive(obama_seasonal_component, h = 24)
obama_seasonaladj_component_mean <- (meanf(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_naive <- (naive(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_snaive <- (snaive(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_drift <- (rwf(obama_seasonaladj_component, h = 24, drift = TRUE))
obama_seasonaladj_component_mean
multiplicativefitted_mean
multiplicativefitted_mean <- obama_seasonaladj_component_mean$mean * obama_seasonal_component_snaive$mean
multiplicativefitted_mean
multiplicativefitted_naive
multiplicativefitted_snaive
autoplot(stl(obama_train, s.window="periodic"))
obama_seasonal_component <- seasonal(decompose(x = obama_train, type = "multiplicative"))
# Check for stationary
nsdiffs(obama_seasonal_component)
ndiffs(diff(obama_seasonal_component, 1))
# obama_seasonal_component <- diff(obama_seasonal_component)
obama_seasonaladj_component <- seasadj(decompose(x = obama_train, type = "multiplicative"))
obama_seasonal_component_snaive <- snaive(obama_seasonal_component, h = 24)
obama_seasonaladj_component_mean <- (meanf(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_naive <- (naive(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_snaive <- (snaive(obama_seasonaladj_component, h = 24))
obama_seasonaladj_component_drift <- (rwf(obama_seasonaladj_component, h = 24, drift = TRUE))
multiplicativefitted_mean <- obama_seasonaladj_component_mean$mean * obama_seasonal_component_snaive$mean
multiplicativefitted_naive <- obama_seasonaladj_component_naive$mean * obama_seasonal_component_snaive$mean
multiplicativefitted_snaive <- obama_seasonaladj_component_snaive$mean * obama_seasonal_component_snaive$mean
multiplicativefitted_drift <- obama_seasonaladj_component_drift$mean * obama_seasonal_component_snaive$mean
obama_multiplicativefitted_mean_resid <- obama_test - InvBoxCox((multiplicativefitted_mean), lambda = obama_lambda)
obama_multiplicativefitted_naive_resid <- obama_test - InvBoxCox((multiplicativefitted_naive), lambda = obama_lambda)
obama_multiplicativefitted_snaive_resid <- obama_test - InvBoxCox((multiplicativefitted_snaive), lambda = obama_lambda)
obama_multiplicativefitted_drift_resid <- obama_test - InvBoxCox((multiplicativefitted_drift), lambda = obama_lambda)
autoplot(obama_test) +
autolayer(InvBoxCox((multiplicativefitted_mean), lambda = obama_lambda)) +
autolayer(InvBoxCox((multiplicativefitted_naive), lambda = obama_lambda))
autoplot(obama_test) +
autolayer(InvBoxCox((multiplicativefitted_mean), lambda = obama_lambda), series = "Mean") +
autolayer(InvBoxCox((multiplicativefitted_naive), lambda = obama_lambda), series = "Naive") +
autolayer(InvBoxCox((multiplicativefitted_snaive), lambda = obama_lambda), series = "Seasonal Naive") +
autolayer(InvBoxCox((multiplicativefitted_drift), lambda = obama_lambda), series = "Drift")
mstl(obama_08_ts)
autoplot(mstl(obama_08_ts))
autoplot(stlf(obama_08_ts))
calls
view(calls)
autplot(calls)
autoplot(calls)
stlf(calls)
calls |> stlf() |> autoplot
calls |>
stlf() |>
autoplot()
calls +
stlf() +
autoplot()
autoplot(mstl(obama_08_pageviews))
autoplot(mstl(obama_08_ts))
autoplot(mstl(obama_ts)) + autolayer(mstl(obama_ts_DA))
autoplot(obama_ts_DA)
autoplot(mstl(obama_ts_DA))
# autoplot(mstl(obama_ts)) + autolayer(mstl(obama_ts_DA))
fit <- auto.arima(obama_ts_DA, seasonal=FALSE, lambda=0,
xreg=fourier(obama_ts_DA, K=c(10,10)))
# autoplot(mstl(obama_ts)) + autolayer(mstl(obama_ts_DA))
fit <- auto.arima(obama_ts_DA, seasonal=FALSE, lambda=0,
xreg=fourier(obama_ts_DA))
# autoplot(mstl(obama_ts)) + autolayer(mstl(obama_ts_DA))
fit <- auto.arima(obama_ts_DA, seasonal=TRUE, lambda=0,
xreg=fourier(obama_ts_DA, K =))
# autoplot(mstl(obama_ts)) + autolayer(mstl(obama_ts_DA))
fit <- auto.arima(obama_ts_DA, seasonal=TRUE, lambda=0,
xreg=fourier(obama_ts_DA, K =1))
autplot(fit)
autoplot(fit)
# autoplot(mstl(obama_ts)) + autolayer(mstl(obama_ts_DA))
fit <- auto.arima(obama_ts_DA, seasonal=TRUE, lambda=0,
xreg=fourier(obama_ts_DA, K =c(10,10)))
# autoplot(mstl(obama_ts)) + autolayer(mstl(obama_ts_DA))
fit <- auto.arima(obama_ts_DA, seasonal=TRUE, lambda=0,
xreg=fourier(obama_ts_DA, K =2))
autoplot(fit)
autoplot(mstl(obama_ts_DA))
obama_mstl <- mstl(obama_ts_DA)
names(obama_mstl)
components(obama_mstl)
names(obama_mstl)
trendcycle(obama_mstl)
seasonal(obama_mstl)
autoplot(mstl(obama_train))
seasadj(obama_mstl)
remainder(obama_mstl)
seasadj(obama_mstl) - (remainder(obama_mstl) + trendcycle(obama_mstl))
# library(httr)
# library(jsonlite)
library(pageviews)
library(fpp2)
library(dplyr)
library(lubridate)
library(ggplot2)
library(forecast)
# 2020
## Democrats
# Obama announced that he would run for president in Feb 2007
obama_pageviews <- article_pageviews(
article = "Barack_Obama",
granularity = "monthly",
start = "2016010100",
end = "2023123100"
)
tail(obama_pageviews)
obama_ts <-ts(data = obama_pageviews$views, start = c(2016,1), frequency = 12)
obama_ts_DA <- obama_ts/monthdays(obama_ts)
obama_ts_DA
autoplot(obama_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average views per day")
# There are significant lags in r1,2,3 and in r19 to 24
obama_lambda <- BoxCox.lambda(obama_ts_DA)
obama_bc <- BoxCox(obama_ts_DA, obama_lambda)
autoplot(obama_bc)
#train-test split
obama_train <- window(obama_bc, start=c(2016, 1), end = c(2021, 12))
obama_test <- window(obama_ts_DA, start = c(2022, 1), end = c(2023, 12))
# Build complex model
## ARIMA
nsdiffs(obama_train) #returns 0
ndiffs(obama_train) #returns 0
acf(obama_ts_DA, lag.max = 96) #slow decaying, indicating presence of AR.
pacf(obama_train, lag.max = 96) #random spikes, indicating seasonal MA component
Arima(obama_train, order = c(1,0,0), seasonal = c(0,0,1))
Arima(obama_train, order = c(1,0,1), seasonal = c(0,0,1))
Arima(obama_train, order = c(1,0,1), seasonal = c(1,0,1))
#ARIMA(1,0,1)(1,0,1) returned the lowest AICc of -1125.53
#auto arima
obama_auto_arima <- auto.arima(obama_train)
obama_auto_arima #auto arima returned ARIMA(1,0,0)(0,0,1) with AICc of -1127.92
#ARIMA forecasting
obama_arima <- Arima(obama_train, order = c(1,0,1), seasonal = c(1,0,1))
obama_auto_arima_fc <- forecast(obama_auto_arima, h = 24)
obama_arima_fc <- forecast(obama_arima, h = 24)
obama_arima_fc
checkresiduals(obama_arima_fc)
checkresiduals(obama_auto_arima_fc)
obama_auto_arima_error <-  (InvBoxCox(unlist(obama_auto_arima_fc$mean) , lambda = obama_lambda) - obama_test)
mean(obama_auto_arima_error)
obama_arima_error <-  (InvBoxCox(unlist(obama_arima_fc$mean) , lambda = obama_lambda) - obama_test)
mean(obama_arima_error)
#Auto ARIMA gave a lower absolute error
autoplot(InvBoxCox(unlist(obama_arima_fc$mean) , lambda = obama_lambda), series = "ARIMA(1,0,1)(1,0,1)") + autolayer(obama_test) + autolayer(InvBoxCox(unlist(obama_auto_arima_fc$mean) , lambda = obama_lambda), series = "ARIMA(1,0,0)(0,0,1)")
