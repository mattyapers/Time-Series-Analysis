start = "2007093000",
end = "2023123100"
)
tail(obama_pageviews)
tail(obama_pageviews)
head(obama_pageviews)
obama_pageviews <- article_pageviews(
article = "Barack_Obama",
granularity = "monthly",
start = "2015013000",
end = "2023123100"
)
tail(obama_pageviews)
head(obama_pageviews)
democratic_2008_pageviews <- article_pageviews(
article = "Democratic_Party_(United_States)",
granularity = "daily",
start = "2008010100",
end = "2016080500"
)
democratic_2008_pageviews
democratic_2008_pageviews
# library(httr)
# library(jsonlite)
library(pageviews)
library(fpp2)
library(dplyr)
library(lubridate)
library(ggplot2)
library(forecast)
# 2020
## Democrats
# Obama announced that he would run for president in Feb 2007
obama_pageviews <- article_pageviews(
article = "Barack_Obama",
granularity = "monthly",
start = "2016010100",
end = "2023123100"
)
tail(obama_pageviews)
obama_ts <-ts(data = obama_pageviews$views, start = c(2016,1), frequency = 12)
obama_ts_DA <- obama_ts/monthdays(obama_ts)
obama_ts_DA
autoplot(obama_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average views per day")
# There are significant lags in r1,2,3 and in r19 to 24
obama_lambda <- BoxCox.lambda(obama_ts_DA)
obama_bc <- BoxCox(obama_ts_DA, obama_lambda)
autoplot(obama_bc)
autoplot(decompose(x = obama_ts_DA, type = "multiplicative"))
autoplot(stl(obama_ts_DA, s.window="periodic"))
obama_seasonal_component <- seasonal(decompose(x = obama_ts_DA, type = "multiplicative"))
obama_seasonaladj_component <- seasadj(decompose(x = obama_ts_DA, type = "multiplicative"))
multiplicativefitted = (snaive(obama_seasonal_component))$fitted * (naive(obama_seasonaladj_component))$fitted
obama_residuals <- obama_ts_DA - multipleClasses()
obama_residuals <- obama_ts_DA - multiplicativefitted
obama_residuals
Box.test(residuals, type = c("Ljung-Box"))
Box.test(obama_residuals, type = c("Ljung-Box"))
load("C:/Users/Matthew/Documents/GitHub/DSA301-Time-Series-Project/.RData")
load("C:/Users/Matthew/Documents/GitHub/DSA301-Time-Series-Project/.RData")
# library(httr)
# library(jsonlite)
library(pageviews)
library(fpp2)
library(dplyr)
library(lubridate)
library(ggplot2)
library(forecast)
# 2020
## Democrats
# Obama announced that he would run for president in Feb 2007
obama_pageviews <- article_pageviews(
article = "Barack_Obama",
granularity = "monthly",
start = "2016010100",
end = "2023123100"
)
tail(obama_pageviews)
obama_ts <-ts(data = obama_pageviews$views, start = c(2016,1), frequency = 12)
obama_ts_DA <- obama_ts/monthdays(obama_ts)
obama_ts_DA
autoplot(obama_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average views per day")
# There are significant lags in r1,2,3 and in r19 to 24
obama_lambda <- BoxCox.lambda(obama_ts_DA)
obama_bc <- BoxCox(obama_ts_DA, obama_lambda)
autoplot(obama_bc)
#train-test split
obama_train <- window(obama_bc, start=c(2016, 1), end = c(2021, 12))
obama_test <- window(obama_ts_DA, start = c(2022, 1), end = c(2023, 12))
#obama_lambda <- BoxCox.lambda(obama_ts_DA)
#autoplot(BoxCox(obama_ts_DA, lambda = obama_lambda))
# Decompose
autoplot(decompose(x = obama_ts_DA, type = "multiplicative")) # amplitude appears to be decreasing over time, hence multiplicative
autoplot(stl(obama_ts_DA, s.window="periodic"))
obama_seasonal_component <- seasonal(decompose(x = obama_ts_DA, type = "multiplicative"))
obama_seasonaladj_component <- seasadj(decompose(x = obama_ts_DA, type = "multiplicative"))
multiplicativefitted <- (snaive(obama_seasonal_component))$fitted * (naive(obama_seasonaladj_component))$fitted
obama_residuals <- obama_ts_DA - multiplicativefitted
Box.test(obama_residuals, type = c("Ljung-Box")) # p-value is 0.01328 < 0.05 reject the null hypothesis. statistically significant autocorrelation in your residuals at some lag within the tested range.
# Build the 4 benchmark models
## Naive
## Snaive
## Drift
## Mean
autoplot(obama_08_ts) + autolayer(obama_residuals)
autoplot(obama_08_ts) + autolayer(multiplicativefitted)
multiplicativefitted
obama_seasonal_component
obama_seasonaladj_component
multiplicativefitted
obama_residuals
autoplot(decompose(x = obama_ts_DA, type = "additive"))
obama_seasonal_component_additive <- seasonal(decompose(x = obama_ts_DA, type = "additive"))
obama_seasonaladj_component_additive <- seasadj(decompose(x = obama_ts_DA, type = "additive"))
additivefitted <- (snaive(obama_seasonal_component_additive))$fitted * (naive(obama_seasonaladj_component_additive))$fitted
obama_residuals_additive <- obama_ts_DA - additivefitted
autoplot(obama_residuals) + autolayer(obama_residuals_additive)
ggplot(obama_residuals)
ggplot(data = obama_residuals)
autoplot(obama_residuals)
autolayer(object = obama_residuals_additive)
autoplot(obama_residuals) + autolayer(obama_residuals_additive)
autoplot(obama_ts_DA) + autolayer(obama_residuals) + autolayer(obama_residuals_additive)
Box.test(obama_residuals_additive, type = c("Ljung-Box"))
accuracy(multiplicativefitted, x = obama_ts_DA)
accuracy(additivefitted, x = obama_ts_DA)
## Naive
autoplot(obama_train)
obama_tesst
obama_test
autolayer(naive(obama_train, h = 24)
autoplot(obama_train) +
## Naive
autoplot(obama_train) +
autolayer(naive(obama_train, h = 24))
## Naive
autoplot(obama_train) +
autolayer(meanf(obama_train, h = 24), series = "Mean") +
autolayer(naive(obama_train, h = 24), series = "Naive") +
autolayer(snaive(obama_train, h = 24), series = "Seasonal Naive")
## Naive
autoplot(obama_train) +
autolayer(meanf(obama_train, h = 24), series = "Mean", PI = FALSE) +
autolayer(naive(obama_train, h = 24), series = "Naive", PI = FALSE) +
autolayer(snaive(obama_train, h = 24), series = "Seasonal Naive", PI = FALSE)
## Naive
autoplot(obama_train) +
autolayer(meanf(obama_train, h = 24), series = "Mean", PI = FALSE) +
autolayer(naive(obama_train, h = 24), series = "Naive", PI = FALSE) +
autolayer(snaive(obama_train, h = 24), series = "Seasonal Naive", PI = FALSE) +
autolayer(rwf(obama_train, drift = TRUE, h = 24), series = "Drift", PI = FALSE)
load("C:/Users/Matthew/Documents/GitHub/DSA301-Time-Series-Project/.RData")
# library(httr)
# library(jsonlite)
library(pageviews)
library(fpp2)
library(dplyr)
library(lubridate)
library(ggplot2)
library(forecast)
## Naive
checkresiduals(meanf(obama_train, h = 24), series = "Mean", PI = FALSE))
## Naive
checkresiduals(meanf(obama_train, h = 24), series = "Mean", PI = FALSE)
## Drift
checkresiduals(rwf(obama_train, drift = TRUE, h = 24), series = "Drift", PI = FALSE)
## Snaive
checkresiduals(snaive(obama_train, h = 24), series = "Seasonal Naive", PI = FALSE)
## Naive
checkresiduals(naive(obama_train, h = 24), series = "Naive", PI = FALSE)
## Mean
checkresiduals(meanf(obama_train, h = 24), series = "Mean", PI = FALSE)
## Mean
checkresiduals(meanf(obama_train, h = 24), series = "Mean", PI = FALSE)
## Naive
checkresiduals(naive(obama_train, h = 24), series = "Naive", PI = FALSE)
## Snaive
checkresiduals(snaive(obama_train, h = 24), series = "Seasonal Naive", PI = FALSE)
## Drift
checkresiduals(rwf(obama_train, drift = TRUE, h = 24), series = "Drift", PI = FALSE)
accuracy(additivefitted, x = obama_ts_DA)
accuracy(multiplicativefitted, x = obama_ts_DA)
# Build the 4 benchmark models
obama_train_mean <- meanf(obama_train, h = 24), series = "Mean", PI = FALSE)
# Build the 4 benchmark models
obama_train_mean <- meanf((obama_train, h = 24), series = "Mean", PI = FALSE))
# Build the 4 benchmark models
obama_train_mean <- meanf(obama_train, h = 24)
obama_train_drift <- rwf(obama_train, drift = TRUE, h = 24)
obama_train_mean <- meanf(obama_train, h = 24)
obama_train_naive <- naive(obama_train, h = 24)
obama_train_snaive <- snaive(obama_train, h = 24)
obama_train_drift <- rwf(obama_train, drift = TRUE, h = 24)
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(naive(obama_train, h = 24), series = "Naive", PI = FALSE) +
autolayer(snaive(obama_train, h = 24), series = "Seasonal Naive", PI = FALSE) +
autolayer(rwf(obama_train, drift = TRUE, h = 24), series = "Drift", PI = FALSE)
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE)
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
accuracy(obama_train_mean, obama_test)
accuracy(obama_train_naive, obama_test)
obama_test
obama_test_mean
obama_train_mean
accuracy(obama_train_mean, obama_test)
obama_train_naive
obama test
obama_test
obama_train
obama_test
accuracy(InvBoxCox(obama_train_mean), obama_test)
accuracy(InvBoxCox(obama_train_mean,lambda = obama_lambda), obama_test)
accuracy(InvBoxCox(obama_train_mean, lambda = obama_lambda), obama_test)
nsdiffs(obama_train)
ndiffs(obama_train)
accuracy(InvBoxCox(unlist(obama_train_mean$mean), lambda = obama_lambda), obama_test)
accuracy(InvBoxCox(unlist(obama_train_mean$mean), lambda = obama_lambda), obama_test)
accuracy(InvBoxCox(unlist(obama_train_naive$mean), lambda = obama_lambda), obama_test)
accuracy(InvBoxCox(unlist(obama_train_snaive$mean), lambda = obama_lambda), obama_test)
accuracy(InvBoxCox(unlist(obama_train_drift$mean), lambda = obama_lambda), obama_test)
# library(httr)
# library(jsonlite)
library(pageviews)
library(fpp2)
library(dplyr)
library(lubridate)
library(ggplot2)
library(forecast)
# old_pageviews looks at data from January 2008 to July 2016
#Description
# This retrieves per-project pageview counts from January 2008 to July 2016. These counts are calculated using the 'legacy' (read: old) model, which overcounts due to its inclusion of web-crawlers and similar automata.
pageview_timestamps(timestamps = Sys.Date(), first = TRUE)
# Basic example
r_pageviews <- article_pageviews()
# 2015-07-01 is the earliest it can access
# 2020
## Democrats
# Obama announced that he would run for president in Feb 2007
obama_pageviews <- article_pageviews(
article = "Barack_Obama",
granularity = "monthly",
start = "2016010100",
end = "2023123100"
)
tail(obama_pageviews)
obama_ts <-ts(data = obama_pageviews$views, start = c(2016,1), frequency = 12)
obama_ts_DA <- obama_ts/monthdays(obama_ts)
obama_ts_DA
autoplot(obama_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average views per day")
# There are significant lags in r1,2,3 and in r19 to 24
obama_lambda <- BoxCox.lambda(obama_ts_DA)
obama_bc <- BoxCox(obama_ts_DA, obama_lambda)
autoplot(obama_bc)
#train-test split
obama_train <- window(obama_bc, start=c(2016, 1), end = c(2021, 12))
obama_test <- window(obama_ts_DA, start = c(2022, 1), end = c(2023, 12))
#obama_lambda <- BoxCox.lambda(obama_ts_DA)
#autoplot(BoxCox(obama_ts_DA, lambda = obama_lambda))
#train-test split
obama_train <- window(obama_bc, start=c(2016, 1), end = c(2021, 12))
obama_test <- window(obama_ts_DA, start = c(2022, 1), end = c(2023, 12))
# Decompose
autoplot(decompose(x = obama_ts_DA, type = "multiplicative")) # amplitude appears to be decreasing over time, hence multiplicative
autoplot(stl(obama_ts_DA, s.window="periodic"))
obama_seasonal_component <- seasonal(decompose(x = obama_ts_DA, type = "multiplicative"))
obama_seasonaladj_component <- seasadj(decompose(x = obama_ts_DA, type = "multiplicative"))
multiplicativefitted <- (snaive(obama_seasonal_component))$fitted * (naive(obama_seasonaladj_component))$fitted
obama_residuals <- obama_ts_DA - multiplicativefitted
autoplot(obama_08_ts) + autolayer(multiplicativefitted)
Box.test(obama_residuals, type = c("Ljung-Box")) # p-value is 0.01328 < 0.05 reject the null hypothesis. statistically significant autocorrelation in residuals at some lag.
multiplicativefitted
# Decompose
autoplot(decompose(x = obama_ts_DA, type = "multiplicative")) # amplitude appears to be decreasing over time, hence multiplicative
autoplot(stl(obama_ts_DA, s.window="periodic"))
obama_seasonal_component <- seasonal(decompose(x = obama_ts_DA, type = "multiplicative"))
obama_seasonaladj_component <- seasadj(decompose(x = obama_ts_DA, type = "multiplicative"))
multiplicativefitted <- (snaive(obama_seasonal_component, h = 24))$fitted * (naive(obama_seasonaladj_component, h = 24))$fitted
obama_residuals <- obama_ts_DA - multiplicativefitted
autoplot(obama_08_ts) + autolayer(multiplicativefitted)
Box.test(obama_residuals, type = c("Ljung-Box")) # p-value is 0.01328 < 0.05 reject the null hypothesis. statistically significant autocorrelation in residuals at some lag.
obama_ts_DA
# Decompose
autoplot(decompose(x = obama_ts_DA, type = "multiplicative")) # amplitude appears to be decreasing over time, hence multiplicative
autoplot(stl(obama_ts_DA, s.window="periodic"))
obama_seasonal_component <- seasonal(decompose(x = obama_ts_DA, type = "multiplicative"))
obama_seasonaladj_component <- seasadj(decompose(x = obama_ts_DA, type = "multiplicative"))
multiplicativefitted <- (snaive(obama_seasonal_component, h = 24))$fitted * (naive(obama_seasonaladj_component, h = 24))$fitted
obama_residuals <- obama_ts_DA - multiplicativefitted
autoplot(obama_ts_DA) + autolayer(multiplicativefitted)
Box.test(obama_residuals, type = c("Ljung-Box")) # p-value is 0.01328 < 0.05 reject the null hypothesis. statistically significant autocorrelation in residuals at some lag.
# Decompose
autoplot(decompose(x = obama_ts_DA, type = "multiplicative")) # amplitude appears to be decreasing over time, hence multiplicative
autoplot(stl(obama_ts_DA, s.window="periodic"))
obama_seasonal_component <- seasonal(decompose(x = obama_ts_DA, type = "multiplicative"))
obama_seasonaladj_component <- seasadj(decompose(x = obama_ts_DA, type = "multiplicative"))
multiplicativefitted <- (snaive(obama_seasonal_component))$fitted * (naive(obama_seasonaladj_component))$fitted
obama_residuals <- obama_ts_DA - multiplicativefitted
autoplot(obama_ts_DA) + autolayer(multiplicativefitted)
Box.test(obama_residuals, type = c("Ljung-Box")) # p-value is 0.01328 < 0.05 reject the null hypothesis. statistically significant autocorrelation in residuals at some lag.
autoplot(decompose(x = obama_ts_DA, type = "additive"))
obama_seasonal_component_additive <- seasonal(decompose(x = obama_ts_DA, type = "additive"))
obama_seasonaladj_component_additive <- seasadj(decompose(x = obama_ts_DA, type = "additive"))
additivefitted <- (snaive(obama_seasonal_component_additive))$fitted * (naive(obama_seasonaladj_component_additive))$fitted
obama_residuals_additive <- obama_ts_DA - additivefitted
Box.test(obama_residuals_additive, type = c("Ljung-Box")) # p-value is 0.9752 > 0.05 do not reject the null hypothesis. Residuals do not contain autocorrelation.
autoplot(obama_ts_DA) + autolayer(obama_residuals) + autolayer(obama_residuals_additive) # Multiplicative decomposition is indeed better
accuracy(additivefitted, x = obama_ts_DA)
accuracy(multiplicativefitted, x = obama_ts_DA) # Multiplicative has smaller MAE, RMSE, MAPE
autoplot(decompose(x = obama_ts_DA, type = "additive"))
obama_seasonal_component_additive <- seasonal(decompose(x = obama_ts_DA, type = "additive"))
obama_seasonaladj_component_additive <- seasadj(decompose(x = obama_ts_DA, type = "additive"))
additivefitted <- (snaive(obama_seasonal_component_additive))$fitted * (naive(obama_seasonaladj_component_additive))$fitted
obama_residuals_additive <- obama_ts_DA - additivefitted
Box.test(obama_residuals_additive, type = c("Ljung-Box")) # p-value is 0.9752 > 0.05 do not reject the null hypothesis. Residuals do not contain autocorrelation.
autoplot(obama_ts_DA) + autolayer(obama_residuals) + autolayer(obama_residuals_additive) # Multiplicative decomposition is indeed better
accuracy(additivefitted, x = obama_ts_DA)
accuracy(multiplicativefitted, x = obama_ts_DA) # Multiplicative has smaller MAE, RMSE, MAPE
autoplot(decompose(x = obama_ts_DA, type = "additive"))
obama_seasonal_component_additive <- seasonal(decompose(x = obama_ts_DA, type = "additive"))
obama_seasonaladj_component_additive <- seasadj(decompose(x = obama_ts_DA, type = "additive"))
additivefitted <- (snaive(obama_seasonal_component_additive))$fitted * (naive(obama_seasonaladj_component_additive))$fitted
obama_residuals_additive <- obama_ts_DA - additivefitted
Box.test(obama_residuals_additive, type = c("Ljung-Box")) # p-value is 0.9752 > 0.05 do not reject the null hypothesis. Residuals do not contain autocorrelation.
autoplot(obama_ts_DA) + autolayer(obama_residuals) + autolayer(obama_residuals_additive) # Multiplicative decomposition is indeed better
accuracy(additivefitted, x = obama_ts_DA)
accuracy(multiplicativefitted, x = obama_ts_DA) # Multiplicative has smaller MAE, RMSE, MAPE
obama_train_mean <- meanf(obama_train, h = 24)
obama_train_naive <- naive(obama_train, h = 24)
obama_train_snaive <- snaive(obama_train, h = 24)
obama_train_drift <- rwf(obama_train, drift = TRUE, h = 24)
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
#train-test split
obama_train <- window(obama_bc, start=c(2016, 1), end = c(2021, 12))
obama_test <- window(obama_ts_DA, start = c(2022, 1), end = c(2023, 12))
obama_train_mean <- meanf(obama_train, h = 24)
obama_train_naive <- naive(obama_train, h = 24)
obama_train_snaive <- snaive(obama_train, h = 24)
obama_train_drift <- rwf(obama_train, drift = TRUE, h = 24)
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
obama_train_mean <- meanf(obama_train, h = 24)
obama_train_naive <- naive(obama_train, h = 24)
obama_train_snaive <- snaive(obama_train, h = 24)
obama_train_drift <- rwf(obama_train, drift = TRUE, h = 24)
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
obama_train_mean <- meanf(obama_train, h = 24)
obama_train_naive <- naive(obama_train, h = 24)
obama_train_snaive <- snaive(obama_train, h = 24)
obama_train_drift <- rwf(obama_train, drift = TRUE, h = 24)
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") +
#guides(colour = guide_legend(title = "Forecast"))
## Mean
checkresiduals(meanf(obama_train, h = 24), series = "Mean", PI = FALSE) # There is significant autocorrelation, residuals are normally distributed, mean of the residuals is close to 0
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") #+
obama_train_mean <- meanf(obama_train, h = 24)
obama_train_naive <- naive(obama_train, h = 24)
obama_train_snaive <- snaive(obama_train, h = 24)
obama_train_drift <- rwf(obama_train, drift = TRUE, h = 24)
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") #+
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") #+
autoplot(obama_train)
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE)
autoplot(obama_train) +
plot(obama_train_mean, series = "Mean", PI = FALSE)
autoplot(obama_train) +
plot(obama_train_mean, PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") #+
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE)
autoplot(obama_train) +
plot(obama_train_mean, series = "Mean", PI = FALSE)
# Build complex model
## ARIMA
nsdiffs(obama_train) #returns 0
ndiffs(obama_train) #returns 0
acf(obama_ts_DA, lag.max = 96) #slow decaying, indicating presence of AR.
pacf(obama_train, lag.max = 96) #random spikes, indicating seasonal MA component
Arima(obama_train, order = c(1,0,0), seasonal = c(0,0,1))
Arima(obama_train, order = c(1,0,1), seasonal = c(0,0,1))
Arima(obama_train, order = c(1,0,1), seasonal = c(1,0,1))
#ARIMA(1,0,1)(1,0,1) returned the lowest AICc of -1125.53
#auto arima
obama_auto_arima <- auto.arima(obama_train)
obama_auto_arima #auto arima returned ARIMA(1,0,0)(0,0,1) with AICc of -1127.92
#ARIMA forecasting
obama_arima <- Arima(obama_train, order = c(1,0,1), seasonal = c(1,0,1))
obama_auto_arima_fc <- forecast(obama_auto_arima, h = 24)
obama_arima_fc <- forecast(obama_arima, h = 24)
obama_arima_fc
checkresiduals(obama_arima_fc)
checkresiduals(obama_auto_arima_fc)
obama_auto_arima_error <-  (InvBoxCox(unlist(obama_auto_arima_fc$mean) , lambda = obama_lambda) - obama_test)
mean(obama_auto_arima_error)
obama_arima_error <-  (InvBoxCox(unlist(obama_arima_fc$mean) , lambda = obama_lambda) - obama_test)
mean(obama_arima_error)
#Auto ARIMA gave a lower absolute error
autoplot(InvBoxCox(unlist(obama_arima_fc$mean) , lambda = obama_lambda), series = "ARIMA(1,0,1)(1,0,1)") + autolayer(obama_test) + autolayer(InvBoxCox(unlist(obama_auto_arima_fc$mean) , lambda = obama_lambda), series = "ARIMA(1,0,0)(0,0,1)")
# Build complex model
## ARIMA
nsdiffs(obama_train) #returns 0
ndiffs(obama_train) #returns 0
acf(obama_ts_DA, lag.max = 96) #slow decaying, indicating presence of AR.
pacf(obama_train, lag.max = 96) #random spikes, indicating seasonal MA component
Arima(obama_train, order = c(1,0,0), seasonal = c(0,0,1))
Arima(obama_train, order = c(1,0,1), seasonal = c(0,0,1))
Arima(obama_train, order = c(1,0,1), seasonal = c(1,0,1))
#ARIMA(1,0,1)(1,0,1) returned the lowest AICc of -1125.53
#auto arima
obama_auto_arima <- auto.arima(obama_train)
obama_auto_arima #auto arima returned ARIMA(1,0,0)(0,0,1) with AICc of -1127.92
#ARIMA forecasting
obama_arima <- Arima(obama_train, order = c(1,0,1), seasonal = c(1,0,1))
obama_auto_arima_fc <- forecast(obama_auto_arima, h = 24)
obama_arima_fc <- forecast(obama_arima, h = 24)
obama_arima_fc
checkresiduals(obama_arima_fc)
checkresiduals(obama_auto_arima_fc)
obama_auto_arima_error <-  (InvBoxCox(unlist(obama_auto_arima_fc$mean) , lambda = obama_lambda) - obama_test)
mean(obama_auto_arima_error)
obama_arima_error <-  (InvBoxCox(unlist(obama_arima_fc$mean) , lambda = obama_lambda) - obama_test)
mean(obama_arima_error)
#Auto ARIMA gave a lower absolute error
autoplot(InvBoxCox(unlist(obama_arima_fc$mean) , lambda = obama_lambda), series = "ARIMA(1,0,1)(1,0,1)") + autolayer(obama_test) + autolayer(InvBoxCox(unlist(obama_auto_arima_fc$mean) , lambda = obama_lambda), series = "ARIMA(1,0,0)(0,0,1)")
obama_train_mean <- meanf(obama_train, h = 24)
obama_train_naive <- naive(obama_train, h = 24)
obama_train_snaive <- snaive(obama_train, h = 24)
obama_train_drift <- rwf(obama_train, drift = TRUE, h = 24)
autoplot(obama_train) +
autolayer(obama_train_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Average Daily Views") +
ggtitle("Forecasts for Average Daily Views on Barrack Obama") #+
## Naive
checkresiduals(naive(obama_train, h = 24), series = "Naive", PI = FALSE) # There is no significant autocorrelation else for the first lag,residuals are relatively normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_naive$mean), lambda = obama_lambda), obama_test)
