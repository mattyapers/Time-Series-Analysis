autoplot(mstl(obama_08_ts))
autoplot(stlf(obama_08_ts))
calls
view(calls)
autplot(calls)
autoplot(calls)
stlf(calls)
calls |> stlf() |> autoplot
calls |>
stlf() |>
autoplot()
calls +
stlf() +
autoplot()
autoplot(mstl(obama_08_pageviews))
autoplot(mstl(obama_08_ts))
autoplot(mstl(obama_ts)) + autolayer(mstl(obama_ts_DA))
autoplot(obama_ts_DA)
autoplot(mstl(obama_ts_DA))
# autoplot(mstl(obama_ts)) + autolayer(mstl(obama_ts_DA))
fit <- auto.arima(obama_ts_DA, seasonal=FALSE, lambda=0,
xreg=fourier(obama_ts_DA, K=c(10,10)))
# autoplot(mstl(obama_ts)) + autolayer(mstl(obama_ts_DA))
fit <- auto.arima(obama_ts_DA, seasonal=FALSE, lambda=0,
xreg=fourier(obama_ts_DA))
# autoplot(mstl(obama_ts)) + autolayer(mstl(obama_ts_DA))
fit <- auto.arima(obama_ts_DA, seasonal=TRUE, lambda=0,
xreg=fourier(obama_ts_DA, K =))
# autoplot(mstl(obama_ts)) + autolayer(mstl(obama_ts_DA))
fit <- auto.arima(obama_ts_DA, seasonal=TRUE, lambda=0,
xreg=fourier(obama_ts_DA, K =1))
autplot(fit)
autoplot(fit)
# autoplot(mstl(obama_ts)) + autolayer(mstl(obama_ts_DA))
fit <- auto.arima(obama_ts_DA, seasonal=TRUE, lambda=0,
xreg=fourier(obama_ts_DA, K =c(10,10)))
# autoplot(mstl(obama_ts)) + autolayer(mstl(obama_ts_DA))
fit <- auto.arima(obama_ts_DA, seasonal=TRUE, lambda=0,
xreg=fourier(obama_ts_DA, K =2))
autoplot(fit)
autoplot(mstl(obama_ts_DA))
obama_mstl <- mstl(obama_ts_DA)
names(obama_mstl)
components(obama_mstl)
names(obama_mstl)
trendcycle(obama_mstl)
seasonal(obama_mstl)
autoplot(mstl(obama_train))
seasadj(obama_mstl)
remainder(obama_mstl)
seasadj(obama_mstl) - (remainder(obama_mstl) + trendcycle(obama_mstl))
# library(httr)
# library(jsonlite)
library(pageviews)
library(fpp2)
library(dplyr)
library(lubridate)
library(ggplot2)
library(forecast)
# 2020
## Democrats
# Obama announced that he would run for president in Feb 2007
obama_pageviews <- article_pageviews(
article = "Barack_Obama",
granularity = "monthly",
start = "2016010100",
end = "2023123100"
)
tail(obama_pageviews)
obama_ts <-ts(data = obama_pageviews$views, start = c(2016,1), frequency = 12)
obama_ts_DA <- obama_ts/monthdays(obama_ts)
obama_ts_DA
autoplot(obama_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average views per day")
# There are significant lags in r1,2,3 and in r19 to 24
obama_lambda <- BoxCox.lambda(obama_ts_DA)
obama_bc <- BoxCox(obama_ts_DA, obama_lambda)
autoplot(obama_bc)
#train-test split
obama_train <- window(obama_bc, start=c(2016, 1), end = c(2021, 12))
obama_test <- window(obama_ts_DA, start = c(2022, 1), end = c(2023, 12))
# Build complex model
## ARIMA
nsdiffs(obama_train) #returns 0
ndiffs(obama_train) #returns 0
acf(obama_ts_DA, lag.max = 96) #slow decaying, indicating presence of AR.
pacf(obama_train, lag.max = 96) #random spikes, indicating seasonal MA component
Arima(obama_train, order = c(1,0,0), seasonal = c(0,0,1))
Arima(obama_train, order = c(1,0,1), seasonal = c(0,0,1))
Arima(obama_train, order = c(1,0,1), seasonal = c(1,0,1))
#ARIMA(1,0,1)(1,0,1) returned the lowest AICc of -1125.53
#auto arima
obama_auto_arima <- auto.arima(obama_train)
obama_auto_arima #auto arima returned ARIMA(1,0,0)(0,0,1) with AICc of -1127.92
#ARIMA forecasting
obama_arima <- Arima(obama_train, order = c(1,0,1), seasonal = c(1,0,1))
obama_auto_arima_fc <- forecast(obama_auto_arima, h = 24)
obama_arima_fc <- forecast(obama_arima, h = 24)
obama_arima_fc
checkresiduals(obama_arima_fc)
checkresiduals(obama_auto_arima_fc)
obama_auto_arima_error <-  (InvBoxCox(unlist(obama_auto_arima_fc$mean) , lambda = obama_lambda) - obama_test)
mean(obama_auto_arima_error)
obama_arima_error <-  (InvBoxCox(unlist(obama_arima_fc$mean) , lambda = obama_lambda) - obama_test)
mean(obama_arima_error)
#Auto ARIMA gave a lower absolute error
autoplot(InvBoxCox(unlist(obama_arima_fc$mean) , lambda = obama_lambda), series = "ARIMA(1,0,1)(1,0,1)") + autolayer(obama_test) + autolayer(InvBoxCox(unlist(obama_auto_arima_fc$mean) , lambda = obama_lambda), series = "ARIMA(1,0,0)(0,0,1)")
rm(obama_08_pageviews)
rm(obama_08_part2_ts)
rm(obama_combined_pageviews)
rm(biden_08_pageviews)
rm(biden_08_part2_ts)
rm(biden_08_ts)
nsdiffs(obama_bc_daily)
library(pageviews)
library(fpp2)
library(dplyr)
library(lubridate)
library(ggplot2)
library(forecast)
obama_pageviews_daily <- article_pageviews(
article = "Barack_Obama",
granularity = "daily",
start = "2016010100",
end = "2023123100"
)
obama_ts_daily <-ts(data = obama_pageviews_daily$views, start = c(2016,1), frequency = 365)
autoplot(obama_ts_daily)
obama_lambda_daily <- BoxCox.lambda(obama_ts_daily)
obama_bc_daily <- BoxCox(obama_ts_daily, obama_lambda_daily)
nsdiffs(obama_bc_daily)
autoplot(obama_bc_daily)
ndiffs(obama_bc_daily)
obama_bc_daily <- diff(obama_bc_daily,1)
autoplot(obama_bc_daily)
nsdiffs(obama_bc)
ndiffs(obama_bc)
obama_bc <- diff(obama_bc,1)
autoplot(obama_bc)
obama_pageviews <- article_pageviews(
article = "Barack_Obama",
granularity = "monthly",
start = "2016010100",
end = "2023123100"
)
obama_ts <-ts(data = obama_pageviews$views, start = c(2016,1), frequency = 12)
obama_ts_DA <- obama_ts/monthdays(obama_ts)
obama_ts_DA
autoplot(obama_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average views per day")
obama_ts_DA
autoplot(obama_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average views per day in a month")
# There are significant lags in r1,2,3 and in r19 to 24
obama_lambda <- BoxCox.lambda(obama_ts_DA)
obama_bc <- BoxCox(obama_ts_DA, obama_lambda)
autoplot(obama_bc)
obama_bc <- diff(obama_bc,1)
autoplot(obama_bc)
library(pageviews)
library(fpp2)
library(dplyr)
library(lubridate)
library(ggplot2)
library(forecast)
# 2016 Obama Pageviews
## Monthly Pageviews
obama_pageviews <- article_pageviews(
article = "Barack_Obama",
granularity = "monthly",
start = "2016010100",
end = "2023123100"
)
tail(obama_pageviews)
# Average daily views per month
obama_ts <-ts(data = obama_pageviews$views, start = c(2016,1), frequency = 12)
obama_ts_DA <- obama_ts/monthdays(obama_ts)
obama_ts_DA
autoplot(obama_ts_DA) +
xlab("Years") + ylab("Views") +
ggtitle("Average views per day in a month")
obama_lambda <- BoxCox.lambda(obama_ts_DA)
obama_bc <- BoxCox(obama_ts_DA, obama_lambda)
ndiffs(obama_bc)
obama_bc <- diff(obama_bc,1)
autoplot(obama_bc)
obama_pageviews_daily <- article_pageviews(
article = "Barack_Obama",
granularity = "daily",
start = "2016010100",
end = "2023123100"
)
obama_ts_daily <-ts(data = obama_pageviews_daily$views, start = c(2016,1), frequency = 365)
autoplot(obama_ts_daily)
obama_lambda_daily <- BoxCox.lambda(obama_ts_daily)
obama_bc_daily <- BoxCox(obama_ts_daily, obama_lambda_daily)
ndiffs(obama_bc_daily)
obama_bc_daily <- diff(obama_bc_daily,1)
autoplot(obama_bc_daily)
autoplot(obama_ts_daily)
#train-test split
obama_train <- window(obama_bc, start=c(2016, 1), end = c(2021, 12))
obama_test <- window(obama_ts_DA, start = c(2022, 1), end = c(2023, 12))
?mstl()
autoplot(mstl(obama_ts_daily))
components(mstl(obama_ts_daily))
component(mstl(obama_ts_daily))
library(feasts)
install.packages("feasts")
library(feasts)
component(mstl(obama_ts_daily))
components(mstl(obama_ts_daily))
(mstl(obama_ts_daily))
mstl(obama_ts_daily, s.window = 12)
autoplot(mstl(obama_ts_daily, s.window = 12))
autoplot(mstl(obama_ts_daily))
autoplot(mstl(obama_ts_daily, s.window = 12))
autoplot(mstl(obama_ts_daily, s.window = "periodic")
autoplot(mstl(obama_ts_daily, s.window = "periodic"))
autoplot(mstl(obama_ts_daily, s.window = "periodic"))
autoplot(msts(obama_ts_daily, seasonal.periods = c(7, 365.25))
msts
autoplot(msts(obama_ts_daily, seasonal.periods = c(7, 365.25))
msts(obama_ts_daily)
msts(obama_ts_daily)
msts(obama_ts_daily, seasonal.periods = (7))
autoplot(msts(obama_ts_daily, seasonal.periods = (7)))
autoplot(msts(obama_ts_daily, seasonal.periods = c(7,12)))
mstl(msts(obama_ts_daily, seasonal.periods = c(7,12,365)))
mstl(msts(obama_ts_daily, seasonal.periods = c(7,12,365)))
autoplot(mstl(msts(obama_ts_daily, seasonal.periods = c(7,12,365))))
obama_mstl <- (mstl(msts(obama_ts_daily, seasonal.periods = c(7,12,365))))
seasonal(obama_mstl)
obama_msts <- msts(obama_ts_daily, seasonal.periods = c(7,12,365)))
obama_msts <- msts(obama_ts_daily, seasonal.periods = c(7,12,365))
autoplot(obama_msts)
BoxCox.lambda(obama_msts)
BoxCox.lambda(obama_mstl)
BoxCox.lambda(obama_msts)
obama_lambda_daily
#train-test split
obama_train <- window(obama_bc, start=c(2016, 1), end = c(2021, 12))
obama_test <- window(obama_ts_DA, start = c(2022, 1), end = c(2023, 12))
#train-test split daily
obama_train_daily <- window(obama_bc_daily, start=c(2016, 1), end = c(2021, 12))
obama_test_daily <- window(obama_ts_daily, start = c(2022, 1), end = c(2023, 12))
#train-test split daily
obama_train_daily <- window(obama_bc_daily, start = c(2016, 1), end = c(2021, 12))
obama_train_daily
head(obama_train_daily)
obama_ts_daily
head(obama_ts_daily)
#train-test split daily
obama_train_daily <- window(obama_bc_daily, end = c(2021, 12))
head(obama_train_daily)
#train-test split daily
obama_train_daily <- window(obama_bc_daily,start = c(2016, 1), end = c(2021, 12))
obama_bc_daily <- diff(obama_bc_daily,1)
#train-test split daily
obama_train_daily <- window(obama_bc_daily,start = c(2016, 1), end = c(2021, 12))
obama_test_daily <- window(obama_ts_daily, start = c(2022, 1), end = c(2023, 12))
obama_lambda_daily <- BoxCox.lambda(obama_ts_daily)
obama_bc_daily <- BoxCox(obama_ts_daily, obama_lambda_daily)
ndiffs(obama_bc_daily)
obama_bc_daily <- diff(obama_bc_daily,1)
autoplot(obama_bc_daily)
#train-test split
obama_train <- window(obama_bc, start=c(2016, 1), end = c(2021, 12))
obama_test <- window(obama_ts_DA, start = c(2022, 1), end = c(2023, 12))
#train-test split daily
obama_train_daily <- window(obama_bc_daily,start = c(2016, 1), end = c(2021, 12))
obama_test_daily <- window(obama_ts_daily, start = c(2022, 1), end = c(2023, 12))
obama_train_daily_mean <- meanf(obama_train_daily, h = 24)
obama_train_daily_naive <- naive(obama_train_daily, h = 24)
obama_train_daily_snaive <- snaive(obama_train_daily, h = 24)
obama_train_daily_drift <- rwf(obama_train_daily, drift = TRUE, h = 24)
autoplot(obama_train_daily) +
autolayer(obama_train_daily_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_daily_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_daily_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_daily_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Daily Views") +
ggtitle("Forecasts for Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
obama_train_daily_mean <- meanf(obama_train_daily, h = 24)
obama_train_daily_naive <- naive(obama_train_daily, h = 24)
obama_train_daily_snaive <- snaive(obama_train_daily, h = 24)
obama_train_daily_drift <- rwf(obama_train_daily, drift = TRUE, h = 24)
autoplot(obama_train_daily) +
autolayer(obama_train_daily_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_daily_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_daily_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_daily_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Daily Views") +
ggtitle("Forecasts for Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
## Mean
checkresiduals(meanf(obama_train_daily, h = 24), series = "Mean", PI = FALSE) # There is significant autocorrelation, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_mean$mean), lambda = obama_lambda_daily), obama_test)
## Naive
checkresiduals(naive(obama_train_daily, h = 24), series = "Naive", PI = FALSE) # There is no significant autocorrelation else for the first lag,residuals are relatively normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_naive$mean), lambda = obama_lambda_daily), obama_test)
## Snaive
checkresiduals(snaive(obama_train_daily, h = 24), series = "Seasonal Naive", PI = FALSE) # There is significant autocorrelation in a decaying pattern, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_snaive$mean), lambda = obama_lambda_daily), obama_test)
## Drift
checkresiduals(rwf(obama_train_daily, drift = TRUE, h = 24), series = "Drift", PI = FALSE) # There is significant autocorrelation for the first lag, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_drift$mean), lambda = obama_lambda_daily), obama_test)
## Mean
checkresiduals(meanf(obama_train_daily, h = 24), series = "Mean", PI = FALSE) # There is significant autocorrelation, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_mean$mean), lambda = obama_lambda_daily), obama_test)
## Mean
checkresiduals(meanf(obama_train_daily, h = 24), series = "Mean", PI = FALSE) # There is significant autocorrelation, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_daily_mean$mean), lambda = obama_lambda_daily), obama_test)
accuracy(InvBoxCox(unlist(obama_train_daily_mean$mean), lambda = obama_lambda_daily), obama_test)
obama_train_daily_mean <- meanf(obama_train_daily, h = 24)
obama_train_daily_naive <- naive(obama_train_daily, h = 24)
obama_train_daily_snaive <- snaive(obama_train_daily, h = 24)
obama_train_daily_drift <- rwf(obama_train_daily, drift = TRUE, h = 24)
autoplot(obama_train_daily) +
autolayer(obama_train_daily_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_daily_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_daily_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_daily_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Daily Views") +
ggtitle("Forecasts for Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
## Mean
checkresiduals(meanf(obama_train_daily, h = 24), series = "Mean", PI = FALSE) # There is significant autocorrelation, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_daily_mean$mean), lambda = obama_lambda_daily), obama_test_daily)
head(obama_train_daily)
# Daily Pageviews
obama_pageviews_daily <- article_pageviews(
article = "Barack_Obama",
granularity = "daily",
start = "2016010100",
end = "2023123100"
)
obama_ts_daily <-ts(data = obama_pageviews_daily$views, start = c(2016,1), frequency = 365)
autoplot(obama_ts_daily)
obama_ts_daily
head(obama_pageviews_daily)
autoplot(obama_ts_daily)
head(obama_ts_daily)
## Transformation
obama_lambda_daily <- BoxCox.lambda(obama_ts_daily)
obama_bc_daily <- BoxCox(obama_ts_daily, obama_lambda_daily)
ndiffs(obama_bc_daily)
nsdiffs(obama_bc_daily)
obama_bc_daily <- diff(obama_bc_daily,1)
head(obama_bc_daily)
autoplot(obama_bc_daily)
#train-test split daily
obama_train_daily <- window(obama_bc_daily,start = c(2016, 2), end = c(2021, 12))
obama_test_daily <- window(obama_ts_daily, start = c(2022, 1), end = c(2023, 12))
obama_train_daily_mean <- meanf(obama_train_daily, h = 24)
obama_train_daily_naive <- naive(obama_train_daily, h = 24)
obama_train_daily_snaive <- snaive(obama_train_daily, h = 24)
obama_train_daily_drift <- rwf(obama_train_daily, drift = TRUE, h = 24)
autoplot(obama_train_daily) +
autolayer(obama_train_daily_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_daily_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_daily_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_daily_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Daily Views") +
ggtitle("Forecasts for Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
## Mean
checkresiduals(meanf(obama_train_daily, h = 24), series = "Mean", PI = FALSE) # There is significant autocorrelation, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_daily_mean$mean), lambda = obama_lambda_daily), obama_test_daily)
autoplot(obama_train_daily) +
autolayer(obama_train_daily_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_daily_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_daily_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_daily_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Daily Views") +
ggtitle("Forecasts for Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
obama_train_daily_mean <- meanf(obama_train_daily, h = 24*365)
obama_train_daily_naive <- naive(obama_train_daily, h = 24*365)
obama_train_daily_snaive <- snaive(obama_train_daily, h = 24*365)
obama_train_daily_drift <- rwf(obama_train_daily, drift = TRUE, h = 24*365)
autoplot(obama_train_daily) +
autolayer(obama_train_daily_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_daily_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_daily_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_daily_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Daily Views") +
ggtitle("Forecasts for Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
## Mean
checkresiduals(meanf(obama_train_daily, h = 24), series = "Mean", PI = FALSE) # There is significant autocorrelation, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_daily_mean$mean), lambda = obama_lambda_daily), obama_test_daily)
## Naive
checkresiduals(naive(obama_train_daily, h = 24), series = "Naive", PI = FALSE) # There is no significant autocorrelation else for the first lag,residuals are relatively normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_daily_naive$mean), lambda = obama_lambda_daily), obama_test_daily)
## Snaive
checkresiduals(snaive(obama_train_daily, h = 24), series = "Seasonal Naive", PI = FALSE) # There is significant autocorrelation in a decaying pattern, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_daily_snaive$mean), lambda = obama_lambda_daily), obama_test_daily)
## Drift
checkresiduals(rwf(obama_train_daily, drift = TRUE, h = 24), series = "Drift", PI = FALSE) # There is significant autocorrelation for the first lag, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_daily_drift$mean), lambda = obama_lambda_daily), obama_test_daily)
obama_train_daily_mean <- meanf(obama_train_daily, h = 24*365)
obama_train_daily_naive <- naive(obama_train_daily, h = 24*365)
obama_train_daily_snaive <- snaive(obama_train_daily, h = 24*365)
obama_train_daily_drift <- rwf(obama_train_daily, drift = TRUE, h = 24*365)
autoplot(obama_train_daily) +
autolayer(obama_train_daily_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_daily_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_daily_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_daily_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Daily Views") +
ggtitle("Forecasts for Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
## Mean
checkresiduals(meanf(obama_train_daily, h = 24), series = "Mean", PI = FALSE) # There is significant autocorrelation, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_daily_mean$mean), lambda = obama_lambda_daily), obama_test_daily)
## Naive
checkresiduals(naive(obama_train_daily, h = 24), series = "Naive", PI = FALSE) # There is no significant autocorrelation else for the first lag,residuals are relatively normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_daily_naive$mean), lambda = obama_lambda_daily), obama_test_daily)
## Snaive
checkresiduals(snaive(obama_train_daily, h = 24), series = "Seasonal Naive", PI = FALSE) # There is significant autocorrelation in a decaying pattern, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_daily_snaive$mean), lambda = obama_lambda_daily), obama_test_daily)
## Drift
checkresiduals(rwf(obama_train_daily, drift = TRUE, h = 24), series = "Drift", PI = FALSE) # There is significant autocorrelation for the first lag, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_daily_drift$mean), lambda = obama_lambda_daily), obama_test_daily)
autoplot(obama_train_daily) +
autolayer(obama_train_daily_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_daily_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_daily_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_daily_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Daily Views") +
ggtitle("Forecasts for Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
obama_train_daily_mean <- meanf(obama_train_daily, h = 24)
obama_train_daily_naive <- naive(obama_train_daily, h = 24)
obama_train_daily_snaive <- snaive(obama_train_daily, h = 24)
obama_train_daily_drift <- rwf(obama_train_daily, drift = TRUE, h = 24)
autoplot(obama_train_daily) +
autolayer(obama_train_daily_mean, series = "Mean", PI = FALSE)
autoplot(obama_test_daily) +
autolayer(obama_train_daily_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_daily_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_daily_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_daily_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Daily Views") +
ggtitle("Forecasts for Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
autoplot(obama_test_daily) +
autolayer(obama_train_daily_mean, series = "Mean", PI = FALSE)
obama_train_daily_mean <- meanf(obama_train_daily, h = 365)
autoplot(obama_test_daily) +
autolayer(obama_train_daily_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_daily_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_daily_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_daily_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Daily Views") +
ggtitle("Forecasts for Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
obama_train_daily_mean <- meanf(obama_train_daily, h = 365*2)
autoplot(obama_test_daily) +
autolayer(obama_train_daily_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_daily_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_daily_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_daily_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Daily Views") +
ggtitle("Forecasts for Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
obama_train_daily_mean
obama_train_daily_mean <- meanf(obama_train_daily, h = 365*2)
obama_train_daily_naive <- naive(obama_train_daily, h = 365*2)
obama_train_daily_snaive <- snaive(obama_train_daily, h = 365*2)
obama_train_daily_drift <- rwf(obama_train_daily, drift = TRUE, h = 365*2)
autoplot(obama_train_daily) +
autolayer(obama_train_daily_mean, series = "Mean", PI = FALSE) +
autolayer(obama_train_daily_naive, series = "Naive", PI = FALSE) +
autolayer(obama_train_daily_snaive, series = "Seasonal Naive", PI = FALSE) +
autolayer(obama_train_daily_drift, series = "Drift", PI = FALSE) +
xlab("Year") + ylab("Daily Views") +
ggtitle("Forecasts for Daily Views on Barrack Obama") +
guides(colour = guide_legend(title = "Forecast"))
## Mean
checkresiduals(meanf(obama_train_daily, h = 365*2), series = "Mean", PI = FALSE) # There is significant autocorrelation, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_daily_mean$mean), lambda = obama_lambda_daily), obama_test_daily)
## Naive
checkresiduals(naive(obama_train_daily, h = 365*2), series = "Naive", PI = FALSE) # There is no significant autocorrelation else for the first lag,residuals are relatively normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_daily_naive$mean), lambda = obama_lambda_daily), obama_test_daily)
## Snaive
checkresiduals(snaive(obama_train_daily, h = 365*2), series = "Seasonal Naive", PI = FALSE) # There is significant autocorrelation in a decaying pattern, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_daily_snaive$mean), lambda = obama_lambda_daily), obama_test_daily)
## Drift
checkresiduals(rwf(obama_train_daily, drift = TRUE, h = 365*2), series = "Drift", PI = FALSE) # There is significant autocorrelation for the first lag, residuals are normally distributed, mean of the residuals is close to 0
accuracy(InvBoxCox(unlist(obama_train_daily_drift$mean), lambda = obama_lambda_daily), obama_test_daily)
obama_seasonal_component_daily <- seasonal(decompose(x = obama_train_daily, type = "multiplicative"))
# Check for stationary
nsdiffs(obama_seasonal_component_daily)
ndiffs(diff(obama_seasonal_component, 1))
# Check for stationary
nsdiffs(obama_seasonal_component_daily)
ndiffs(diff(obama_seasonal_component_daily, 1))
obama_seasonal_component_daily <- diff(obama_seasonal_component_daily,1)
obama_seasonaladj_component_daily <- seasadj(decompose(x = obama_train_daily, type = "multiplicative"))
obama_seasonal_component_daily_snaive <- snaive(obama_seasonal_component, h = 365*2)
obama_seasonaladj_component_daily_mean <- (meanf(obama_seasonaladj_component_daily, h = 365*2))
obama_seasonaladj_component_daily_naive <- (naive(obama_seasonaladj_component_daily, h = 365*2))
obama_seasonaladj_component_daily_snaive <- (snaive(obama_seasonaladj_component_daily, h = 365*2))
obama_seasonaladj_component_daily_drift <- (rwf(obama_seasonaladj_component_daily, h = 365*2, drift = TRUE))
multiplicativefitted_daily_mean <- obama_seasonaladj_component_daily_mean$mean * obama_seasonal_component_daily_snaive$mean
multiplicativefitted_daily_mean <- obama_seasonaladj_component_daily_mean$mean * obama_seasonal_component_daily_snaive$mean
